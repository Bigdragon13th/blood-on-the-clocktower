(function(e){function t(t){for(var o,r,n=t[0],l=t[1],h=t[2],d=0,m=[];d<n.length;d++)r=n[d],Object.prototype.hasOwnProperty.call(s,r)&&s[r]&&m.push(s[r][0]),s[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);c&&c(t);while(m.length)m.shift()();return a.push.apply(a,h||[]),i()}function i(){for(var e,t=0;t<a.length;t++){for(var i=a[t],o=!0,n=1;n<i.length;n++){var l=i[n];0!==s[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=i[0]))}return e}var o={},s={app:0},a=[];function r(t){if(o[t])return o[t].exports;var i=o[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=o,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(i,o,function(t){return e[t]}.bind(null,o));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/townsquare/";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=t,n=n.slice();for(var h=0;h<n.length;h++)t(n[h]);var c=l;a.push(["56d7","chunk-vendors"]),i()})({"00c0":function(e){e.exports=JSON.parse('[{"id":"tb","name":"Trouble Brewing","hasTravelers":true,"description":"Clouds roll in over Ravenswood Bluff, engulfing this sleepy town and its superstitious inhabitants in foreboding shadow. Freshly-washed clothes dance eerily on lines strung between cottages. Chimneys cough plumes of smoke into the air. Exotic scents waft through cracks in windows and under doors, as hidden cauldrons lay bubbling. An unusually warm Autumn breeze wraps around vine-covered walls and whispers ominously to those brave enough to walk the cobbled streets.\\n\\nAnxious mothers call their children home from play, as thunder begins to clap on the horizon. If you listen more closely, however, noises stranger still can be heard echoing from the neighbouring forest. Under the watchful eye of a looming monastery, silhouetted figures skip from doorway to doorway. Those who can read the signs know there is... Trouble Brewing.","level":"Beginner","roles":[]},{"id":"bmr","name":"Bad Moon Rising","hasTravelers":true,"description":"The sun is swallowed by a jagged horizon as another winter\'s day surrenders to the night. Flecks of orange and red decay into deeper browns, the forest transforming in silent anticipation of the coming snow.\\n\\nRavenous wolves howl from the bowels of a rocky crevasse beyond the town borders, sending birds scattering from their cozy rooks. Travelers hurry into the inn, seeking shelter from the gathering chill. They warm themselves with hot tea, sweet strains of music and hearty ale, unaware that strange and nefarious eyes stalk them from the ruins of this once great city.\\n\\nTonight, even the livestock know there is a... Bad Moon Rising.","level":"Intermediate","roles":[]},{"id":"snv","name":"Sects & Violets","hasTravelers":true,"description":"Vibrant spring gives way to a warm and inviting summer. Flowers of every description blossom as far as the eye can see, tenderly nurtured in public gardens and window boxes overlooking the lavish promenade. Birds sing, artists paint and philosophers ponder life\'s greatest mysteries inside a bustling tavern as a circus pitches its endearingly ragged tent on the edge of town.\\n\\nAs the townsfolk bask in frivolity and mischief, indulging themselves in fine entertainment and even finer wine, dark and clandestine forces are assembling. Witches and cults lurk in majestic ruins on the fringes of the community, hosting secret meetings in underground caves and malevolently plotting the downfall of Ravenswood Bluff and its revelers.\\n\\nThe time is ripe for... Sects & Violets.","level":"Intermediate","roles":[]},{"id":"luf","name":"Laissez un Faire","hasTravelers":false,"description":"","level":"Veteran","roles":["balloonist","savant","amnesiac","fisherman","artist","cannibal","mutant","lunatic","widow","goblin","leviathan"]}]')},"013f":function(e,t,i){e.exports=i.p+"img/washerwoman.a0c66e53.png"},"027a":function(e,t,i){e.exports=i.p+"img/barista.fd2bba67.png"},"0436":function(e,t,i){e.exports=i.p+"img/cerenovus.736554ca.png"},"043b":function(e,t,i){e.exports=i.p+"img/amnesiac.03ce8f67.png"},"07ab":function(e,t,i){e.exports=i.p+"img/politician.32246fcf.png"},"0820":function(e,t,i){},"0b29":function(e,t,i){e.exports=i.p+"img/shabaloth.f461dd08.png"},"0b61":function(e,t,i){e.exports=i.p+"img/lunatic.f2982146.png"},"0c12":function(e,t,i){e.exports=i.p+"img/oracle.63459162.png"},"0c59":function(e,t,i){e.exports=i.p+"img/ravenkeeper.552f1f2f.png"},"0d06":function(e,t,i){e.exports=i.p+"img/spiritofivory.1ec5112e.png"},"0e20":function(e,t,i){e.exports=i.p+"img/undertaker.1df72155.png"},"125e":function(e,t,i){e.exports=i.p+"img/chambermaid.b6f002ce.png"},"130a":function(e,t,i){"use strict";var o=i("c37d"),s=i.n(o);s.a},"160b":function(e,t,i){e.exports=i.p+"img/plus.c11bf1ed.png"},1695:function(e,t,i){},"177d":function(e,t,i){e.exports=i.p+"img/recluse.a6519a1d.png"},"17ad":function(e,t,i){e.exports=i.p+"img/mutant.b28a535c.png"},"185d":function(e,t,i){"use strict";var o=i("e5b4"),s=i.n(o);s.a},"1b64":function(e,t,i){},"1b90":function(e,t,i){"use strict";var o=i("1b64"),s=i.n(o);s.a},"1c9f":function(e,t,i){},"1d01":function(e,t,i){e.exports=i.p+"img/buddhist.72caa1e8.png"},"1e83":function(e,t,i){e.exports=i.p+"img/chef.d4e7f9a6.png"},2094:function(e,t,i){e.exports=i.p+"img/preacher.f3f608a6.png"},"20ca":function(e,t,i){e.exports=i.p+"img/zombuul.ec71a259.png"},"223c":function(e,t,i){e.exports=i.p+"img/sailor.631521c2.png"},"22c9":function(e,t,i){e.exports=i.p+"img/widow.ec8d8cb0.png"},"23b1":function(e,t,i){e.exports=i.p+"img/bonecollector.846af8c8.png"},"24d3":function(e,t,i){e.exports=i.p+"img/baron.9ce9bd3b.png"},"25f6":function(e,t,i){e.exports=i.p+"img/bureaucrat.88ec372a.png"},"2b04":function(e,t,i){e.exports=i.p+"img/leviathan.dfbff6e8.png"},"2cd0":function(e,t,i){e.exports=i.p+"img/artist.f89690cd.png"},"30b6":function(e,t,i){e.exports=i.p+"img/sage.5afc100d.png"},"327a":function(e,t,i){e.exports=i.p+"img/scapegoat.8bd95c23.png"},3603:function(e,t,i){e.exports=i.p+"img/philosopher.92032c70.png"},3636:function(e,t,i){"use strict";var o=i("d4b2"),s=i.n(o);s.a},"37dd":function(e,t,i){e.exports=i.p+"img/butcher.e0b672b7.png"},"38a5":function(e,t,i){e.exports=i.p+"img/towncrier.18a4377b.png"},"398f":function(e,t,i){e.exports=i.p+"img/cultleader.de1fca53.png"},"39eb":function(e,t,i){e.exports=i.p+"img/toymaker.07b2e8fa.png"},"3a43":function(e,t,i){e.exports=i.p+"img/vortox.6add3a3a.png"},"3b65":function(e,t,i){e.exports=i.p+"img/deviant.e8a761ae.png"},"3e70":function(e,t,i){e.exports=i.p+"img/imp.cd0fa5b8.png"},"3f65":function(e,t,i){e.exports=i.p+"img/moonchild.6c84161e.png"},"3f8f":function(e,t,i){"use strict";var o=i("557b"),s=i.n(o);s.a},4021:function(e,t,i){e.exports=i.p+"img/snakecharmer.e512cc1e.png"},"43e8":function(e,t,i){e.exports=i.p+"img/fortuneteller.4396927c.png"},"44d0":function(e,t,i){},4720:function(e,t,i){e.exports=i.p+"img/fool.a730aab3.png"},"4bea":function(e,t,i){e.exports=i.p+"img/apprentice.b7055345.png"},"4d73":function(e,t,i){e.exports=i.p+"img/librarian.6fd7f267.png"},"4e76":function(e,t,i){e.exports=i.p+"img/soldier.451de0df.png"},"4e7f":function(e,t,i){"use strict";var o=i("1695"),s=i.n(o);s.a},"4efd":function(e,t,i){e.exports=i.p+"img/minstrel.1647382d.png"},5072:function(e,t,i){e.exports=i.p+"img/exorcist.8c0f5cac.png"},"557b":function(e,t,i){},"559e":function(e,t,i){e.exports=i.p+"img/harlot.1a418200.png"},"55aa":function(e,t,i){e.exports=i.p+"img/goon.719106f2.png"},"56d7":function(e,t,i){"use strict";i.r(t);var o=i("2b0e"),s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{class:{screenshot:e.grimoire.isScreenshot},style:{backgroundImage:e.grimoire.background?"url('"+e.grimoire.background+"')":""},attrs:{id:"app",tabindex:"-1"},on:{keyup:e.keyup}},[i("transition",{attrs:{name:"blur"}},[e.players.length?e._e():i("Intro"),e.players.length&&!e.session.nomination?i("TownInfo"):e._e(),e.session.nomination?i("Vote"):e._e()],1),i("TownSquare",{on:{screenshot:e.takeScreenshot}}),i("Menu",{ref:"menu"}),i("EditionModal"),i("FabledModal"),i("RolesModal"),i("ReferenceModal"),i("NightOrderModal"),i("Gradients"),i("span",{attrs:{id:"version"}},[e._v("v"+e._s(e.version))])],1)},a=[],r=i("2f62"),n=i("9224"),l=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"square",class:{public:e.grimoire.isPublic,spectator:e.session.isSpectator,vote:e.session.nomination},attrs:{id:"townsquare"}},[i("ul",{staticClass:"circle",class:["size-"+e.players.length]},e._l(e.players,(function(t,o){return i("Player",{key:o,class:{from:Math.max(e.swap,e.move,e.nominate)===o,swap:e.swap>-1,move:e.move>-1,nominate:e.nominate>-1},attrs:{player:t},on:{screenshot:function(t){return e.$emit("screenshot",t)},trigger:function(t){return e.handleTrigger(o,t)}}})})),1),e.players.length?i("div",{ref:"bluffs",staticClass:"bluffs",class:{closed:!e.isBluffsOpen}},[i("h3",[i("font-awesome-icon",{attrs:{icon:"camera"},on:{click:function(t){return t.stopPropagation(),e.takeScreenshot(t)}}}),e.session.isSpectator?i("span",[e._v("Other characters")]):i("span",[e._v("Demon bluffs")]),i("font-awesome-icon",{attrs:{icon:"times-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleBluffs(t)}}}),i("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleBluffs(t)}}})],1),i("ul",e._l(e.bluffs,(function(t){return i("li",{key:t,on:{click:function(i){return e.openRoleModal(-1*t)}}},[i("Token",{attrs:{role:e.grimoire.bluffs[t-1]}})],1)})),0)]):e._e(),e.grimoire.fabled.length?i("div",{staticClass:"fabled",class:{closed:!e.isFabledOpen}},[i("h3",[i("span",[e._v("Fabled")]),i("font-awesome-icon",{attrs:{icon:"times-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleFabled(t)}}}),i("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{click:function(t){return t.stopPropagation(),e.toggleFabled(t)}}})],1),i("ul",e._l(e.grimoire.fabled,(function(t,o){return i("li",{key:o,on:{click:function(t){return e.removeFabled(o)}}},[i("Token",{attrs:{role:t}})],1)})),0)]):e._e(),i("ReminderModal",{attrs:{"player-index":e.selectedPlayer}}),i("RoleModal",{attrs:{"player-index":e.selectedPlayer}})],1)},h=[],c=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("li",{style:e.zoom},[o("div",{ref:"player",staticClass:"player",class:[{dead:e.player.isDead,"no-vote":e.player.isVoteless,you:e.session.sessionId&&e.player.id&&e.player.id===e.session.playerId,"vote-yes":e.session.votes[e.index],"vote-lock":e.voteLocked},e.player.role.team]},[o("div",{staticClass:"shroud",on:{click:function(t){return e.toggleStatus()}}}),o("div",{staticClass:"life",on:{click:function(t){return e.toggleStatus()}}}),e.nightOrder.get(e.player).first&&e.grimoire.isNightOrder?o("div",{staticClass:"night first"},[o("em",[e._v(e._s(e.nightOrder.get(e.player).first)+".")]),e.player.role.firstNightReminder?o("span",[e._v(e._s(e._f("handleEmojis")(e.player.role.firstNightReminder)))]):e._e()]):e._e(),e.nightOrder.get(e.player).other&&e.grimoire.isNightOrder?o("div",{staticClass:"night other"},[o("em",[e._v(e._s(e.nightOrder.get(e.player).other)+".")]),e.player.role.otherNightReminder?o("span",[e._v(e._s(e._f("handleEmojis")(e.player.role.otherNightReminder)))]):e._e()]):e._e(),o("Token",{attrs:{role:e.player.role},on:{"set-role":function(t){return e.$emit("trigger",["openRoleModal"])}}}),o("div",{staticClass:"overlay"},[o("font-awesome-icon",{staticClass:"vote",attrs:{icon:"skull",title:"Voted YES"},on:{click:function(t){return e.vote()}}}),o("font-awesome-icon",{staticClass:"vote",attrs:{icon:"times",title:"Voted NO"},on:{click:function(t){return e.vote()}}}),o("font-awesome-icon",{staticClass:"cancel",attrs:{icon:"times-circle",title:"Cancel"},on:{click:function(t){return e.cancel()}}}),o("font-awesome-icon",{staticClass:"swap",attrs:{icon:"exchange-alt",title:"Swap seats with this player"},on:{click:function(t){return e.swapPlayer(e.player)}}}),o("font-awesome-icon",{staticClass:"move",attrs:{icon:"redo-alt",title:"Move player to this seat"},on:{click:function(t){return e.movePlayer(e.player)}}}),o("font-awesome-icon",{staticClass:"nominate",attrs:{icon:"hand-point-right",title:"Nominate this player"},on:{click:function(t){return e.nominatePlayer(e.player)}}})],1),e.player.id&&e.session.sessionId?o("font-awesome-icon",{staticClass:"seat",attrs:{icon:"chair"}}):e._e(),e.player.isDead&&!e.player.isVoteless?o("font-awesome-icon",{staticClass:"has-vote",attrs:{icon:"vote-yea",title:"Ghost vote"},on:{click:function(t){return e.updatePlayer("isVoteless",!0)}}}):e._e(),o("div",{staticClass:"name",class:{active:e.isMenuOpen},on:{click:function(t){e.isMenuOpen=!e.isMenuOpen}}},[e._v(" "+e._s(e.player.name)+" ")]),o("transition",{attrs:{name:"fold"}},[e.isMenuOpen?o("ul",{staticClass:"menu"},[e.session.isSpectator?e._e():[o("li",{on:{click:e.changeName}},[o("font-awesome-icon",{attrs:{icon:"user-edit"}}),e._v("Rename ")],1),e.session.nomination?e._e():o("li",{on:{click:function(t){return e.nominatePlayer()}}},[o("font-awesome-icon",{attrs:{icon:"hand-point-right"}}),e._v(" Nomination ")],1),o("li",{on:{click:function(t){return e.movePlayer()}}},[o("font-awesome-icon",{attrs:{icon:"redo-alt"}}),e._v(" Move player ")],1),o("li",{on:{click:function(t){return e.swapPlayer()}}},[o("font-awesome-icon",{attrs:{icon:"exchange-alt"}}),e._v(" Swap seats ")],1),o("li",{staticClass:"screenshot",on:{click:e.takeScreenshot}},[o("font-awesome-icon",{attrs:{icon:"camera"}}),e._v(" Screenshot ")],1),o("li",{on:{click:e.removePlayer}},[o("font-awesome-icon",{attrs:{icon:"times-circle"}}),e._v(" Remove ")],1)],e.session.isSpectator?o("li",{on:{click:e.claimSeat}},[o("font-awesome-icon",{attrs:{icon:"chair"}}),e.player.id!==e.session.playerId?[e._v(" Claim seat ")]:[e._v(" Vacate seat ")]],2):e._e()],2):e._e()])],1),e.player.reminders?e._l(e.player.reminders,(function(t){return o("div",{key:t.role+" "+t.name,staticClass:"reminder",class:[t.role],on:{click:function(i){return e.removeReminder(t)}}},[o("span",{staticClass:"icon",style:{backgroundImage:"url("+(t.image||i("61b0")("./"+t.role+".png"))+")"}}),o("span",{staticClass:"text"},[e._v(e._s(t.name))])])})):e._e(),o("div",{staticClass:"reminder add",on:{click:function(t){return e.$emit("trigger",["openReminderModal"])}}},[o("span",{staticClass:"icon"})])],2)},d=[],m=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"token",class:[e.role.id],on:{click:e.setRole}},[e.role.id?o("span",{staticClass:"icon",style:{backgroundImage:"url("+(e.role.image||i("61b0")("./"+e.role.id+".png"))+")"}}):e._e(),e.role.firstNight?o("span",{staticClass:"leaf-left"}):e._e(),e.role.otherNight?o("span",{staticClass:"leaf-right"}):e._e(),e.role.reminders&&e.role.reminders.length?o("span",{class:["leaf-top"+e.role.reminders.length]}):e._e(),e.role.setup?o("span",{staticClass:"leaf-orange"}):e._e(),o("svg",{staticClass:"name",attrs:{viewBox:"0 0 150 150"}},[o("path",{attrs:{d:"M 13 75 C 13 160, 138 160, 138 75",id:"curve",fill:"transparent"}}),o("text",{staticClass:"label mozilla",attrs:{width:"150",x:"66.6%","text-anchor":"middle","font-size":e._f("nameToFontSize")(e.role.name)}},[o("textPath",{attrs:{"xlink:href":"#curve"}},[e._v(" "+e._s(e.role.name)+" ")])])]),o("div",{staticClass:"edition",class:["edition-"+e.role.edition,e.role.team]}),e.role.ability?o("div",{staticClass:"ability"},[e._v(" "+e._s(e.role.ability)+" ")]):e._e()])},p=[],g={name:"Token",props:{role:{type:Object,default:()=>({})}},data(){return{}},filters:{nameToFontSize:e=>e&&e.length>10?"90%":"110%"},methods:{setRole(){this.$emit("set-role")}}},u=g,f=(i("5de9"),i("2877")),y=Object(f["a"])(u,m,p,!1,null,"38dedfca",null),b=y.exports,v={components:{Token:b},props:{player:{type:Object,required:!0}},computed:{...Object(r["d"])("players",["players"]),...Object(r["d"])(["grimoire","session"]),...Object(r["b"])({nightOrder:"players/nightOrder"}),index:function(){return this.players.indexOf(this.player)},voteLocked:function(){const e=this.session,t=this.players.length;if(!e.nomination)return!1;const i=(this.index-1+t-e.nomination[1])%t;return i<e.lockedVote-1},zoom:function(){const e=window.innerWidth>window.innerHeight?"vh":"vw";return this.players.length<7?{width:18+this.grimoire.zoom+e}:this.players.length<=10?{width:16+this.grimoire.zoom+e}:this.players.length<=15?{width:14+this.grimoire.zoom+e}:{width:12+this.grimoire.zoom+e}}},data(){return{isMenuOpen:!1,isSwap:!1}},filters:{handleEmojis:e=>e.replace(/:([^: ]+?):/g,"").replace(/ •/g,"\n•")},methods:{takeScreenshot(){const{width:e,height:t,x:i,y:o}=this.$refs.player.getBoundingClientRect();this.$emit("screenshot",{width:e,height:t,x:i,y:o}),this.isMenuOpen=!1},toggleStatus(){this.grimoire.isPublic?this.player.isDead?this.player.isVoteless?(this.updatePlayer("isVoteless",!1),this.updatePlayer("isDead",!1)):this.updatePlayer("isVoteless",!0):this.updatePlayer("isDead",!0):(this.updatePlayer("isDead",!this.player.isDead),this.player.isVoteless&&this.updatePlayer("isVoteless",!1))},changeName(){if(this.session.isSpectator)return;const e=prompt("Player name",this.player.name)||this.player.name;this.updatePlayer("name",e),this.isMenuOpen=!1},removeReminder(e){const t=[...this.player.reminders];t.splice(this.player.reminders.indexOf(e),1),this.updatePlayer("reminders",t),this.isMenuOpen=!1},updatePlayer(e,t){this.session.isSpectator&&"reminders"!==e||this.$store.commit("players/update",{player:this.player,property:e,value:t})},removePlayer(){this.isMenuOpen=!1,this.$emit("trigger",["removePlayer"])},swapPlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["swapPlayer",e])},movePlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["movePlayer",e])},nominatePlayer(e){this.isMenuOpen=!1,this.$emit("trigger",["nominatePlayer",e])},cancel(){this.$emit("trigger",["cancel"])},claimSeat(){this.isMenuOpen=!1,this.$emit("trigger",["claimSeat"])},vote(){this.session.isSpectator||this.voteLocked&&this.$store.commit("session/voteSync",[this.index,!this.session.votes[this.index]])}}},k=v,w=(i("74c9"),Object(f["a"])(k,c,d,!1,null,null,null)),N=w.exports,_=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.players[e.playerIndex]?o("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.reminder&&e.availableReminders.length,expression:"modals.reminder && availableReminders.length"}],on:{close:function(t){return e.toggleModal("reminder")}}},[o("h3",[e._v("Choose a reminder token:")]),o("ul",{staticClass:"reminders"},e._l(e.availableReminders,(function(t){return o("li",{key:t.role+" "+t.name,staticClass:"reminder",class:[t.role],on:{click:function(i){return e.addReminder(t)}}},[o("span",{staticClass:"icon",style:{backgroundImage:"url("+(t.image||i("61b0")("./"+t.role+".png"))+")"}}),o("span",{staticClass:"text"},[e._v(e._s(t.name))])])})),0)]):e._e()},S=[],R=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("transition",{attrs:{name:"modal-fade"}},[i("div",{staticClass:"modal-backdrop",on:{click:e.close}},[i("div",{staticClass:"modal",attrs:{role:"dialog","aria-labelledby":"modalTitle","aria-describedby":"modalDescription"},on:{click:function(e){e.stopPropagation()}}},[i("font-awesome-icon",{staticClass:"close",attrs:{icon:"times-circle"},on:{click:e.close}}),e._t("default")],2)])])},x=[],T={methods:{close(){this.$emit("close")}}},C=T,O=(i("8781"),Object(f["a"])(C,R,x,!1,null,null,null)),I=O.exports,M={components:{Modal:I},props:["playerIndex"],computed:{availableReminders(){let e=[];const t=this.$store.state.players.players;return this.$store.state.roles.forEach(i=>{t.some(e=>e.role.id===i.id)&&(e=[...e,...i.reminders.map(e=>({role:i.id,image:i.image,name:e}))]),i.remindersGlobal&&i.remindersGlobal.length&&(e=[...e,...i.remindersGlobal.map(e=>({role:i.id,image:i.image,name:e}))])}),this.$store.state.grimoire.fabled.forEach(t=>{e=[...e,...t.reminders.map(e=>({role:t.id,image:t.image,name:e}))]}),e.push({role:"good",name:"Good"}),e.push({role:"evil",name:"Evil"}),e.push({role:"custom",name:"Custom note"}),e},...Object(r["d"])(["modals"]),...Object(r["d"])("players",["players"])},methods:{addReminder(e){const t=this.$store.state.players.players[this.playerIndex];let i;if("custom"===e.role){const e=prompt("Add a custom reminder note");if(!e)return;i=[...t.reminders,{role:"custom",name:e}]}else i=[...t.reminders,e];this.$store.commit("players/update",{player:t,property:"reminders",value:i}),this.$store.commit("toggleModal","reminder")},...Object(r["c"])(["toggleModal"])}},P=M,D=(i("d88a"),Object(f["a"])(P,_,S,!1,null,"7e909120",null)),E=D.exports,j=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.role&&e.availableRoles.length,expression:"modals.role && availableRoles.length"}],on:{close:function(t){return e.toggleModal("role")}}},[i("h3",[e._v(" Choose a new character for "+e._s(e.playerIndex>=0&&e.players.length?e.players[e.playerIndex].name:"bluffing")+" ")]),i("ul",{staticClass:"tokens"},e._l(e.availableRoles,(function(t){return i("li",{key:t.id,class:[t.team],on:{click:function(i){return e.setRole(t)}}},[i("Token",{attrs:{role:t}})],1)})),0)])},$=[],V={components:{Token:b,Modal:I},props:["playerIndex"],computed:{availableRoles(){const e=[],t=this.$store.state.players.players;return this.$store.state.roles.forEach(i=>{(this.playerIndex>=0||this.playerIndex<0&&!t.some(e=>e.role.id===i.id))&&e.push(i)}),e.push({}),e},...Object(r["d"])(["modals","roles","session"]),...Object(r["d"])("players",["players"])},methods:{setRole(e){if(this.playerIndex<0)this.$store.commit("setBluff",{index:-1*this.playerIndex-1,role:e});else{if(this.session.isSpectator&&"traveler"===e.team)return;const t=this.$store.state.players.players[this.playerIndex];this.$store.commit("players/update",{player:t,property:"role",value:e})}this.$store.commit("toggleModal","role")},...Object(r["c"])(["toggleModal"])}},A=V,B=(i("ee63"),Object(f["a"])(A,j,$,!1,null,"91110818",null)),G=B.exports,F={components:{Player:N,Token:b,RoleModal:G,ReminderModal:E},computed:{...Object(r["d"])(["grimoire","roles","session"]),...Object(r["d"])("players",["players"])},data(){return{selectedPlayer:0,bluffs:3,swap:-1,move:-1,nominate:-1,isBluffsOpen:!0,isFabledOpen:!0}},methods:{takeScreenshot(){const{width:e,height:t,x:i,y:o}=this.$refs.bluffs.getBoundingClientRect();this.$emit("screenshot",{width:e,height:t,x:i,y:o})},toggleBluffs(){this.isBluffsOpen=!this.isBluffsOpen},toggleFabled(){this.isFabledOpen=!this.isFabledOpen},removeFabled(e){this.session.isSpectator||this.$store.commit("setFabled",{index:e})},handleTrigger(e,[t,i]){"function"===typeof this[t]&&this[t](e,i)},claimSeat(e){this.session.isSpectator&&(this.session.playerId===this.players[e].id?this.$store.commit("session/claimSeat",-1):this.$store.commit("session/claimSeat",e))},openReminderModal(e){this.selectedPlayer=e,this.$store.commit("toggleModal","reminder")},openRoleModal(e){const t=this.players[e];this.session.isSpectator&&t&&"traveler"===t.role.team||(this.selectedPlayer=e,this.$store.commit("toggleModal","role"))},removePlayer(e){this.session.isSpectator||confirm(`Do you really want to remove ${this.players[e].name}?`)&&this.$store.commit("players/remove",e)},swapPlayer(e,t){void 0===t?(this.cancel(),this.swap=e):(this.$store.commit("players/swap",[this.swap,this.players.indexOf(t)]),this.cancel())},movePlayer(e,t){void 0===t?(this.cancel(),this.move=e):(this.$store.commit("players/move",[this.move,this.players.indexOf(t)]),this.cancel())},nominatePlayer(e,t){if(void 0===t)this.cancel(),e!==this.nominate&&(this.nominate=e);else{const e=[this.nominate,this.players.indexOf(t)];this.$store.commit("session/nomination",{nomination:e}),this.cancel()}},cancel(){this.move=-1,this.swap=-1,this.nominate=-1}}},L=F,W=(i("3636"),Object(f["a"])(L,l,h,!1,null,null,null)),z=W.exports,Y=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",{staticClass:"info"},[i("li",{staticClass:"edition",class:["edition-"+e.edition]}),e.players.length-e.teams.traveler<5?i("li",[e._v(" Please add more players! ")]):e._e(),i("li",[e._v(" "+e._s(e.players.length)+" "),i("font-awesome-icon",{staticClass:"players",attrs:{icon:"users"}}),e._v(" "+e._s(e.teams.alive)+" "),i("font-awesome-icon",{staticClass:"alive",attrs:{icon:"heartbeat"}}),e._v(" "+e._s(e.teams.votes)+" "),i("font-awesome-icon",{staticClass:"votes",attrs:{icon:"vote-yea"}})],1),e.players.length-e.teams.traveler>=5?i("li",[e._v(" "+e._s(e.teams.townsfolk)+" "),i("font-awesome-icon",{staticClass:"townsfolk",attrs:{icon:"user-friends"}}),e._v(" "+e._s(e.teams.outsider)+" "),i("font-awesome-icon",{staticClass:"outsider",attrs:{icon:e.teams.outsider>1?"user-friends":"user"}}),e._v(" "+e._s(e.teams.minion)+" "),i("font-awesome-icon",{staticClass:"minion",attrs:{icon:e.teams.minion>1?"user-friends":"user"}}),e._v(" "+e._s(e.teams.demon)+" "),i("font-awesome-icon",{staticClass:"demon",attrs:{icon:e.teams.demon>1?"user-friends":"user"}}),e.teams.traveler?[e._v(" "+e._s(e.teams.traveler)+" "),i("font-awesome-icon",{staticClass:"traveler",attrs:{icon:e.teams.traveler>1?"user-friends":"user"}})]:e._e()],2):e._e()])},U=[],J=i("634a"),q={computed:{teams:function(){const{players:e}=this.$store.state.players,t=this.$store.getters["players/nonTravelers"],i=e.filter(e=>!0!==e.isDead).length;return{...J[t-5],traveler:e.length-t,alive:i,votes:i+e.filter(e=>!0===e.isDead&&!0!==e.isVoteless).length}},...Object(r["d"])(["edition"]),...Object(r["d"])("players",["players"])}},H=q,Z=(i("b201"),Object(f["a"])(H,Y,U,!1,null,"280b29dc",null)),K=Z.exports,Q=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"controls"}},[i("Screenshot",{ref:"screenshot"}),e.session.sessionId?i("span",{staticClass:"session",class:{spectator:e.session.isSpectator},attrs:{title:e.session.playerCount+" other players in this session ("+e.session.ping+"ms latency)"},on:{click:e.leaveSession}},[i("font-awesome-icon",{attrs:{icon:"broadcast-tower"}}),e._v(" "+e._s(e.session.playerCount)+" ")],1):e._e(),i("span",{staticClass:"camera"},[i("font-awesome-icon",{class:{success:e.grimoire.isScreenshotSuccess},attrs:{icon:"camera",title:"Take a screenshot"},on:{click:function(t){return e.takeScreenshot()}}})],1),i("div",{staticClass:"menu",class:{open:e.grimoire.isMenuOpen}},[i("font-awesome-icon",{attrs:{icon:"cog"},on:{click:e.toggleMenu}}),i("ul",[i("li",{staticClass:"tabs",class:e.tab},[i("font-awesome-icon",{attrs:{icon:"book-open"},on:{click:function(t){e.tab="grimoire"}}}),i("font-awesome-icon",{attrs:{icon:"broadcast-tower"},on:{click:function(t){e.tab="session"}}}),e.session.isSpectator?e._e():i("font-awesome-icon",{attrs:{icon:"users"},on:{click:function(t){e.tab="players"}}}),i("font-awesome-icon",{attrs:{icon:"theater-masks"},on:{click:function(t){e.tab="characters"}}}),i("font-awesome-icon",{attrs:{icon:"question"},on:{click:function(t){e.tab="help"}}})],1),"grimoire"===e.tab?[i("li",{staticClass:"headline"},[e._v("Grimoire")]),e.players.length?i("li",{on:{click:e.toggleGrimoire}},[e.grimoire.isPublic?e._e():[e._v("Hide")],e.grimoire.isPublic?[e._v("Show")]:e._e(),i("em",[e._v("[G]")])],2):e._e(),e.players.length?i("li",{on:{click:e.toggleNightOrder}},[e._v(" Night order "),i("em",[i("font-awesome-icon",{attrs:{icon:["fas",e.grimoire.isNightOrder?"check-square":"square"]}})],1)]):e._e(),e.session.isSpectator?e._e():i("li",{on:{click:function(t){return e.toggleModal("fabled")}}},[e._v(" Add Fabled "),i("em",[i("font-awesome-icon",{attrs:{icon:"dragon"}})],1)]),e.players.length?i("li",[e._v(" Zoom "),i("em",[i("font-awesome-icon",{attrs:{icon:"search-minus"},on:{click:function(t){return e.setZoom(e.grimoire.zoom-1)}}}),e._v(" "+e._s(Math.round(100+10*e.grimoire.zoom))+"% "),i("font-awesome-icon",{attrs:{icon:"search-plus"},on:{click:function(t){return e.setZoom(e.grimoire.zoom+1)}}})],1)]):e._e(),i("li",{on:{click:e.setBackground}},[e._v(" Background image "),i("em",[i("font-awesome-icon",{attrs:{icon:"image"}})],1)])]:e._e(),"session"===e.tab?[e.session.sessionId?i("li",{staticClass:"headline"},[e._v(" "+e._s(e.session.isSpectator?"Playing":"Hosting")+" ")]):i("li",{staticClass:"headline"},[e._v(" Live Session ")]),e.session.sessionId?e._e():i("li",{on:{click:e.hostSession}},[e._v(" Host (Storyteller)"),i("em",[e._v("[H]")])]),e.session.sessionId?e._e():i("li",{on:{click:e.joinSession}},[e._v(" Join (Player)"),i("em",[e._v("[J]")])]),e.session.sessionId&&e.session.ping?i("li",[e._v(" Delay to "+e._s(e.session.isSpectator?"host":"players")+" "),i("em",[e._v(e._s(e.session.ping)+"ms")])]):e._e(),e.session.sessionId?i("li",{on:{click:e.copySessionUrl}},[e._v(" Copy player link "),i("em",[i("font-awesome-icon",{attrs:{icon:"copy"}})],1)]):e._e(),e.session.sessionId?i("li",{on:{click:e.leaveSession}},[e._v(" Leave Session "),i("em",[e._v(e._s(e.session.sessionId))])]):e._e()]:e._e(),"players"!==e.tab||e.session.isSpectator?e._e():[i("li",{staticClass:"headline"},[e._v("Players")]),e.players.length<20?i("li",{on:{click:e.addPlayer}},[e._v("Add"),i("em",[e._v("[A]")])]):e._e(),e.players.length>2?i("li",{on:{click:e.randomizeSeatings}},[e._v(" Randomize "),i("em",[i("font-awesome-icon",{attrs:{icon:"dice"}})],1)]):e._e(),e.players.length?i("li",{on:{click:e.clearPlayers}},[e._v(" Remove all "),i("em",[i("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1)]):e._e()],"characters"===e.tab?[i("li",{staticClass:"headline"},[e._v("Characters")]),e.session.isSpectator?e._e():i("li",{on:{click:function(t){return e.toggleModal("edition")}}},[e._v(" Select Edition "),i("em",[e._v("[E]")])]),!e.session.isSpectator&&e.players.length>4?i("li",{on:{click:function(t){return e.toggleModal("roles")}}},[e._v(" Choose & Assign "),i("em",[e._v("[C]")])]):e._e(),e.players.length?i("li",{on:{click:e.clearRoles}},[e._v(" Remove all "),i("em",[i("font-awesome-icon",{attrs:{icon:"trash-alt"}})],1)]):e._e()]:e._e(),"help"===e.tab?[i("li",{staticClass:"headline"},[e._v("Help")]),i("li",{on:{click:function(t){return e.toggleModal("reference")}}},[e._v(" Reference Sheet "),i("em",[e._v("[R]")])]),i("li",{on:{click:function(t){return e.toggleModal("nightOrder")}}},[e._v(" Night Order Sheet "),i("em",[e._v("[N]")])]),i("li",[i("a",{attrs:{href:"https://discord.gg/tkWDny6",target:"_blank"}},[e._v(" Join Discord ")]),i("em",[i("font-awesome-icon",{attrs:{icon:["fab","discord"]}})],1)]),i("li",[i("a",{attrs:{href:"https://github.com/bra1n/townsquare",target:"_blank"}},[e._v(" Source code ")]),i("em",[i("font-awesome-icon",{attrs:{icon:["fab","github"]}})],1)])]:e._e()],2)],1)],1)},X=[],ee=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"screenshot"}},[i("video",{ref:"video",attrs:{autoplay:""}}),i("canvas",{ref:"canvas"})])},te=[],ie={data:function(){return{stream:null}},methods:{async capture({x:e=0,y:t=0,width:i=0,height:o=0}){const s=this.$refs.canvas,a=this.$refs.video;if(!this.stream||!this.stream.active){alert("Please select to stream the current browser tab to get the appropriate screenshots");try{this.stream=await navigator.mediaDevices.getDisplayMedia({video:{cursor:"never"},audio:!1})}catch(r){this.$store.commit("updateScreenshot",!1)}}this.stream&&this.stream.active&&(a.srcObject=this.stream,a.play(),setTimeout(()=>{const n=s.getContext("2d");s.setAttribute("width",i||a.videoWidth),s.setAttribute("height",o||a.videoHeight),n.drawImage(a,e||0,t||0,i||a.videoWidth,o||a.videoHeight,0,0,i||a.videoWidth,o||a.videoHeight),s.toBlob(e=>{try{const t=new ClipboardItem({"image/png":e});navigator.clipboard.write([t]),this.$store.commit("updateScreenshot",!0)}catch(r){this.$store.commit("updateScreenshot",!1)}})},100))}}},oe=ie,se=(i("1b90"),Object(f["a"])(oe,ee,te,!1,null,"6443af38",null)),ae=se.exports,re={components:{Screenshot:ae},computed:{...Object(r["d"])(["grimoire","session"]),...Object(r["d"])("players",["players"])},data(){return{tab:"grimoire"}},methods:{takeScreenshot(e={}){this.$store.commit("updateScreenshot"),this.$refs.screenshot.capture(e)},setBackground(){const e=prompt("Enter custom background URL");(e||""===e)&&this.$store.commit("setBackground",e)},hostSession(){const e=prompt("Enter a channel number / name for your session",Math.round(1e4*Math.random()));e&&(this.$store.commit("session/setSpectator",!1),this.$store.commit("session/setSessionId",e.toLocaleLowerCase().replace(/[^0-9a-z]/g,"").substr(0,10)),this.copySessionUrl())},copySessionUrl(){navigator.permissions.query({name:"clipboard-write"}).then(({state:e})=>{if("granted"===e||"prompt"===e){const e=window.location.href.split("#")[0],t=e+"#play/"+this.session.sessionId;navigator.clipboard.writeText(t)}})},joinSession(){const e=prompt("Enter the channel number / name of the session you want to join");e&&(this.$store.commit("session/setSpectator",!0),this.$store.commit("session/setSessionId",e.toLocaleLowerCase().replace(/[^0-9a-z]/g,"").substr(0,10)))},leaveSession(){confirm("Are you sure you want to leave the active live game?")&&(this.$store.commit("session/setSpectator",!1),this.$store.commit("session/setSessionId",""))},addPlayer(){if(this.session.isSpectator)return;if(this.players.length>=20)return;const e=prompt("Player name");e&&this.$store.commit("players/add",e)},randomizeSeatings(){this.session.isSpectator||confirm("Are you sure you want to randomize seatings?")&&this.$store.dispatch("players/randomize")},clearPlayers(){this.session.isSpectator||confirm("Are you sure you want to remove all players?")&&(this.$store.commit("players/clear"),this.$store.commit("setBluff"))},clearRoles(){confirm("Are you sure you want to remove all player roles?")&&(this.$store.dispatch("players/clearRoles"),this.$store.commit("setBluff"))},...Object(r["c"])(["toggleGrimoire","toggleMenu","toggleNightOrder","updateScreenshot","setZoom","toggleModal"])}},ne=re,le=(i("98c6"),Object(f["a"])(ne,Q,X,!1,null,"13dd3a47",null)),he=le.exports,ce=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.nonTravelers>=5?i("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.roles,expression:"modals.roles"}],staticClass:"roles",on:{close:function(t){return e.toggleModal("roles")}}},[i("h3",[e._v("Select the characters for "+e._s(e.nonTravelers)+" players:")]),e._l(e.roleSelection,(function(t,o){return i("ul",{key:o,staticClass:"tokens"},[i("li",{staticClass:"count",class:[o]},[e._v(" "+e._s(t.filter((function(e){return e.selected})).length)+" / "+e._s(e.game[e.nonTravelers-5][o])+" ")]),e._l(t,(function(e){return i("li",{key:e.id,class:[e.team,e.selected?"selected":""],on:{click:function(t){e.selected=!e.selected}}},[i("Token",{attrs:{role:e}})],1)}))],2)})),e.hasSelectedSetupRoles?i("div",{staticClass:"warning"},[e._v(" Warning: there are characters selected that modify the game setup! The randomizer does not account for these characters. ")]):e._e(),i("div",{staticClass:"button-group"},[i("div",{staticClass:"button",class:{disabled:e.selectedRoles>e.nonTravelers||!e.selectedRoles},on:{click:e.assignRoles}},[i("font-awesome-icon",{attrs:{icon:"people-arrows"}}),e._v(" Assign "+e._s(e.selectedRoles)+" characters randomly ")],1),i("div",{staticClass:"button",on:{click:e.selectRandomRoles}},[i("font-awesome-icon",{attrs:{icon:"random"}}),e._v(" Shuffle characters ")],1)])],2):e._e()},de=[];const me=e=>e[Math.floor(Math.random()*e.length)];var pe={components:{Token:b,Modal:I},data:function(){return{roleSelection:{},game:J}},computed:{selectedRoles:function(){return Object.values(this.roleSelection).map(e=>e.filter(e=>e.selected).length).reduce((e,t)=>e+t,0)},hasSelectedSetupRoles:function(){return Object.values(this.roleSelection).some(e=>e.some(e=>e.selected&&e.setup))},...Object(r["d"])(["roles","modals"]),...Object(r["d"])("players",["players"]),...Object(r["b"])({nonTravelers:"players/nonTravelers"})},methods:{selectRandomRoles(){this.roleSelection={},this.roles.forEach(e=>{this.roleSelection[e.team]||this.$set(this.roleSelection,e.team,[]),this.roleSelection[e.team].push(e),this.$set(e,"selected",!1)}),delete this.roleSelection["traveler"];const e=Math.max(5,this.nonTravelers),t=this.game[e-5];Object.keys(t).forEach(e=>{for(let i=0;i<t[e];i++)if(this.roleSelection[e]){const t=this.roleSelection[e].filter(e=>!0!==e.selected);t.length&&(me(t).selected=!0)}})},assignRoles(){if(this.selectedRoles<=this.nonTravelers&&this.selectedRoles){const e=Object.values(this.roleSelection).map(e=>e.filter(e=>e.selected)).reduce((e,t)=>[...e,...t],[]).map(e=>[Math.random(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1]);this.players.forEach(t=>{if("traveler"!==t.role.team&&e.length){const i=e.pop();this.$store.commit("players/update",{player:t,property:"role",value:i})}}),this.$store.commit("toggleModal","roles")}},...Object(r["c"])(["toggleModal"])},mounted:function(){Object.keys(this.roleSelection).length||this.selectRandomRoles()},watch:{roles(){this.selectRandomRoles()}}},ge=pe,ue=(i("8527"),Object(f["a"])(ge,ce,de,!1,null,"75057598",null)),fe=ue.exports,ye=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.edition,expression:"modals.edition"}],staticClass:"editions",on:{close:function(t){return e.toggleModal("edition")}}},[e.isCustom?i("div",{staticClass:"custom"},[i("h3",[e._v("Load custom script / characters")]),e._v(" To play with a custom script, you need to select the characters you want to play with in the official "),i("a",{attrs:{href:"https://bloodontheclocktower.com/script-tool/",target:"_blank"}},[e._v("Script Tool")]),e._v(' and then upload the generated "custom-list.json" either directly here or provide a URL to such a hosted JSON file.'),i("br"),i("br"),e._v(" To play with custom characters, please read "),i("a",{attrs:{href:"https://github.com/bra1n/townsquare#custom-characters",target:"_blank"}},[e._v("the documentation")]),e._v(" on how to write a custom character definition file. "),i("h3",[e._v("Some popular custom scripts:")]),i("ul",{staticClass:"scripts"},e._l(e.scripts,(function(t,o){return i("li",{key:o,on:{click:function(i){return e.handleURL(t[1])}}},[e._v(" "+e._s(t[0])+" ")])})),0),i("input",{ref:"upload",attrs:{type:"file",accept:"application/json"},on:{change:e.handleUpload}}),i("div",{staticClass:"button-group"},[i("div",{staticClass:"button",on:{click:e.openUpload}},[i("font-awesome-icon",{attrs:{icon:"file-upload"}}),e._v(" Upload JSON ")],1),i("div",{staticClass:"button",on:{click:e.promptURL}},[i("font-awesome-icon",{attrs:{icon:"link"}}),e._v(" Enter URL ")],1),i("div",{staticClass:"button",on:{click:function(t){e.isCustom=!1}}},[i("font-awesome-icon",{attrs:{icon:"undo"}}),e._v(" Back ")],1)])]):i("div",[i("h3",[e._v("Select an edition:")]),i("ul",{staticClass:"editions"},[e._l(e.editions,(function(t){return i("li",{key:t.id,staticClass:"edition",class:["edition-"+t.id],on:{click:function(i){return e.setEdition(t.id)}}},[e._v(" "+e._s(t.name)+" ")])})),i("li",{staticClass:"edition edition-custom",on:{click:function(t){e.isCustom=!0}}},[e._v(" Custom Script / Characters ")])],2)])])},be=[],ve=i("00c0"),ke={components:{Modal:I},data:function(){return{editions:ve,isCustom:!1,scripts:[["Deadly Penance Day","https://gist.githubusercontent.com/bra1n/0337cc44c6fd2c44f7589256ed5486d2/raw/4a7a1545004620146f47583cde4b05f77dd9b6d2/penanceday.json"],["Catfishing 9.0","https://gist.githubusercontent.com/bra1n/8a5ec41a7bbf945f6b7dfc1cef72b569/raw/998767f82badc48cbb9c284765ad36330f7e28f6/catfishing.json"],["On Thin Ice (Teensyville)","https://gist.githubusercontent.com/bra1n/8dacd9f2abc6f428331ea1213ab153f5/raw/0cacbcaf8ed9bddae0cca25a9ada97e9958d868b/on-thin-ice.json"],["Race To The Bottom (Teensyville)","https://gist.githubusercontent.com/bra1n/63e1354cb3dc9d4032bcd0623dc48888/raw/5acb0eedcc0a67a64a99c7e0e6271de0b7b2e1b2/race-to-the-bottom.json"],["Frankenstein's Mayor by Ted (Teensyville)","https://gist.githubusercontent.com/bra1n/32c52b422cc01b934a4291eeb81dbcee/raw/5bf770693bbf7aff5e86601c82ca4af3222f4ba6/Frankensteins_Mayor_by_Ted.json"],["Vigormortis High School (Teensyville)","https://gist.githubusercontent.com/bra1n/1f65bd4a999524719d5dabe98c3c2d27/raw/22bbec6bf56a51a7459e5ae41ed47e41971c5445/VigormortisHighSchool.json"]]}},computed:Object(r["d"])(["modals"]),methods:{openUpload(){this.$refs.upload.click()},handleUpload(){const e=this.$refs.upload.files[0];if(e&&e.size){const t=new FileReader;t.addEventListener("load",()=>{try{const e=JSON.parse(t.result);this.parseRoles(e)}catch(e){alert("Error reading custom script: "+e.message)}this.$refs.upload.value=""}),t.readAsText(e)}},promptURL(){const e=prompt("Enter URL to a custom-script.json file");e&&this.handleURL(e)},async handleURL(e){const t=await fetch(e);if(t&&t.json)try{const e=await t.json();this.parseRoles(e)}catch(i){alert("Error loading custom script: "+i.message)}},parseRoles(e){if(!e||!e.length)return;const t=e.map(e=>(e.id=e.id.toLocaleLowerCase().replace(/[^a-z0-9]/g,""),e));if(this.$store.commit("setCustomRoles",t),this.$store.commit("setEdition","custom"),t.some(({id:e})=>this.$store.state.fabled.has(e))){const e=[];t.forEach(({id:t})=>{this.$store.state.fabled.has(t)&&e.push(this.$store.state.fabled.get(t))}),this.$store.commit("setFabled",{fabled:e})}this.isCustom=!1},...Object(r["c"])(["toggleModal","setEdition"])}},we=ke,Ne=(i("cf8b"),Object(f["a"])(we,ye,be,!1,null,"4c00b703",null)),_e=Ne.exports,Se=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"intro"},[i("img",{attrs:{src:"static/apple-icon.png",alt:""}}),e._v(" Welcome to the (unofficial) "),i("b",[e._v(" Virtual Blood on the Clocktower Town Square")]),e._v("!"),i("br"),e._v(" Please add more players through the "),i("span",{staticClass:"button",on:{click:e.toggleMenu}},[i("font-awesome-icon",{attrs:{icon:"cog"}}),e._v(" Menu ")],1),e._v(" on the top right or by pressing "),i("b",[e._v("[A]")]),e._v("."),i("br"),e._v(" This project is free and open source and can be found on "),i("a",{attrs:{href:"https://github.com/bra1n/townsquare",target:"_blank"}},[e._v("GitHub")]),e._v(". ")])},Re=[],xe={methods:Object(r["c"])(["toggleMenu"])},Te=xe,Ce=(i("4e7f"),Object(f["a"])(Te,Se,Re,!1,null,"64d39c3f",null)),Oe=Ce.exports,Ie=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.roles.size?o("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.reference,expression:"modals.reference"}],staticClass:"characters",on:{close:function(t){return e.toggleModal("reference")}}},[o("font-awesome-icon",{staticClass:"toggle",attrs:{icon:"cloud-moon",title:"Show Night Order"},on:{click:function(t){return e.toggleModal("nightOrder")}}}),o("h3",[e._v(" Character Reference "),o("font-awesome-icon",{attrs:{icon:"address-card"}}),e._v(" "+e._s(e.editionName)+" ")],1),o("ul",{staticClass:"legend"},[o("li",[o("span",{staticClass:"name"},[e._v("Name")]),o("span",{staticClass:"icon"},[e._v("Icon")]),o("span",{staticClass:"ability"},[e._v("Ability")]),Object.keys(e.playersByRole).length?o("span",{staticClass:"player"},[e._v(" Player ")]):e._e()])]),e._l(e.rolesGrouped,(function(t,s){return o("div",{key:s,class:[s]},[o("h4",[e._v(e._s(s))]),o("ul",e._l(t,(function(t){return o("li",{key:t.id,class:[s]},[o("span",{staticClass:"name"},[e._v(e._s(t.name))]),t.id?o("span",{staticClass:"icon",style:{backgroundImage:"url("+(t.image||i("61b0")("./"+t.id+".png"))+")"}}):e._e(),o("span",{staticClass:"ability"},[e._v(e._s(t.ability))]),Object.keys(e.playersByRole).length?o("span",{staticClass:"player"},[e._v(e._s(e.playersByRole[t.id]?e.playersByRole[t.id].join(", "):""))]):e._e()])})),0)])}))],2):e._e()},Me=[],Pe={components:{Modal:I},data:function(){return{roleSelection:{}}},computed:{editionName:function(){const e=ve.find(({id:e})=>e===this.edition);return e?e.name:"Custom Script"},rolesGrouped:function(){const e={};return this.roles.forEach(t=>{e[t.team]||(e[t.team]=[]),e[t.team].push(t)}),delete e["traveler"],e},playersByRole:function(){const e={};return this.players.forEach(({name:t,role:i})=>{i&&i.id&&"traveler"!==i.team&&(e[i.id]||(e[i.id]=[]),e[i.id].push(t))}),e},...Object(r["d"])(["roles","modals","edition"]),...Object(r["d"])("players",["players"])},methods:{...Object(r["c"])(["toggleModal"])}},De=Pe,Ee=(i("b391"),Object(f["a"])(De,Ie,Me,!1,null,"5e15bbc8",null)),je=Ee.exports,$e=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"vote"}},[i("div",{staticClass:"arrows"},[i("span",{staticClass:"nominee",style:e.nomineeStyle}),i("span",{staticClass:"nominator",style:e.nominatorStyle})]),i("div",{staticClass:"overlay"},[i("em",{staticClass:"blue"},[e._v(e._s(e.nominator.name))]),e._v(" nominated "),i("em",[e._v(e._s(e.nominee.name))]),e._v("! "),i("br"),"traveler"!==e.nominee.role.team?[i("em",{staticClass:"blue"},[e._v(" "+e._s(e.voters.length)+" vote"+e._s(1!==e.voters.length?"s":"")+" ")]),e._v(" in favor "),i("em",[e._v("(majority is "+e._s(Math.ceil(e.alive/2))+")")])]:[i("em",[e._v(e._s(Math.ceil(e.players.length/2))+" votes")]),e._v(" required for a "),i("em",[e._v("majority")]),e._v(". ")],e.session.lockedVote>1?i("div",[e.voters.length?i("em",{staticClass:"blue"},[e._v(e._s(e.voters.join(", "))+" ")]):i("span",[e._v("nobody")]),e._v(" voted "),i("em",[e._v("YES")])]):e._e(),e.session.isSpectator?e.canVote?[e.session.lockedVote?e._e():i("div",[e._v(" "+e._s(e.session.votingSpeed)+" seconds between votes ")]),i("div",{staticClass:"button-group"},[i("div",{staticClass:"button vote-no",on:{click:function(t){return e.vote(!1)}}},[e._v("Vote NO")]),i("div",{staticClass:"button vote-yes",on:{click:function(t){return e.vote(!0)}}},[e._v("Vote YES")])])]:e.player?e._e():i("div",[e._v(" Please claim a seat to vote. ")]):[e.session.lockedVote?e._e():i("div",[e._v(" Vote time per player: "),i("font-awesome-icon",{attrs:{icon:"minus-circle"},on:{mousedown:function(t){return t.preventDefault(),e.setVotingSpeed(-1)}}}),e._v(" "+e._s(e.session.votingSpeed)+"s "),i("font-awesome-icon",{attrs:{icon:"plus-circle"},on:{mousedown:function(t){return t.preventDefault(),e.setVotingSpeed(1)}}})],1),i("div",{staticClass:"button-group"},[e.session.lockedVote?i("div",{staticClass:"button",on:{click:e.stop}},[e._v(" Reset Vote ")]):i("div",{staticClass:"button",on:{click:e.start}},[e._v(" Start Vote ")]),i("div",{staticClass:"button",on:{click:e.finish}},[e._v("Finish")])])]],2)])},Ve=[],Ae={computed:{...Object(r["d"])("players",["players"]),...Object(r["d"])(["session"]),...Object(r["b"])({alive:"players/alive"}),nominator:function(){return this.players[this.session.nomination[0]]},nominatorStyle:function(){const e=this.players.length,t=this.session.nomination[0];return{transform:`rotate(${Math.round(t/e*360)}deg)`,transitionDuration:this.session.votingSpeed-.1+"s"}},nominee:function(){return this.players[this.session.nomination[1]]},nomineeStyle:function(){const e=this.players.length,t=this.session.nomination[1],i=this.session.lockedVote,o=360*(t+Math.min(i,e))/e;return{transform:`rotate(${Math.round(o)}deg)`,transitionDuration:this.session.votingSpeed-.1+"s"}},player:function(){return this.players.find(e=>e.id===this.session.playerId)},canVote:function(){if(!this.player)return!1;if(this.player.isVoteless&&"traveler"!==this.nominee.role.team)return!1;const e=this.session,t=this.players.length,i=this.players.indexOf(this.player),o=(i-1+t-e.nomination[1])%t;return o>=e.lockedVote-1},voters:function(){const e=this.session.nomination[1],t=this.session.votes.map((e,t)=>e?this.players[t].name:""),i=[...t.slice(e+1,this.players.length),...t.slice(0,e+1)];return i.slice(0,this.session.lockedVote-1).filter(e=>!!e)}},methods:{start(){this.$store.commit("session/lockVote"),clearInterval(this.voteTimer),this.voteTimer=setInterval(()=>{this.$store.commit("session/lockVote"),this.session.lockedVote>this.players.length&&clearInterval(this.voteTimer)},1e3*this.session.votingSpeed)},stop(){clearInterval(this.voteTimer),this.$store.commit("session/lockVote",0)},finish(){clearInterval(this.voteTimer),this.$store.commit("session/nomination")},vote(e){if(!this.canVote)return!1;const t=this.players.findIndex(e=>e.id===this.session.playerId);t>=0&&!!this.session.votes[t]!==e&&this.$store.commit("session/voteSync",[t,e])},setVotingSpeed(e){const t=this.session.votingSpeed+e;t>0&&this.$store.commit("session/setVotingSpeed",t)}}},Be=Ae,Ge=(i("185d"),Object(f["a"])(Be,$e,Ve,!1,null,"91b5d918",null)),Fe=Ge.exports,Le=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"gradients"}},e._l(e.gradients,(function(e,t){return i("svg",{key:t,attrs:{width:"0",height:"0"}},[i("linearGradient",{attrs:{id:e[0],x1:"50%",y1:"100%",x2:"50%",y2:"0%"}},[i("stop",{style:{"stop-color":e[2],"stop-opacity":1},attrs:{offset:"0%"}}),i("stop",{style:{"stop-color":e[1],"stop-opacity":1},attrs:{offset:"100%"}})],1)],1)})),0)},We=[],ze={data(){return{gradients:[["demon","#ce0100","#000"],["townsfolk","#1f65ff","#000"],["default","#4E4E4E","#000"]]}}},Ye=ze,Ue=(i("3f8f"),Object(f["a"])(Ye,Le,We,!1,null,"1e202a64",null)),Je=Ue.exports,qe=function(){var e=this,t=e.$createElement,o=e._self._c||t;return e.roles.size?o("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.nightOrder,expression:"modals.nightOrder"}],staticClass:"characters",on:{close:function(t){return e.toggleModal("nightOrder")}}},[o("font-awesome-icon",{staticClass:"toggle",attrs:{icon:"address-card",title:"Show Character Reference"},on:{click:function(t){return e.toggleModal("reference")}}}),o("h3",[e._v(" Night Order "),o("font-awesome-icon",{attrs:{icon:"cloud-moon"}}),e._v(" "+e._s(e.editionName)+" ")],1),o("div",{staticClass:"night"},[o("ul",{staticClass:"first"},[o("li",{staticClass:"headline"},[e._v("First Night")]),e._l(e.rolesFirstNight,(function(t){return o("li",{key:t.id,class:[t.team]},[o("span",{staticClass:"name"},[e._v(" "+e._s(t.name)+" ")]),t.id?o("span",{staticClass:"icon",style:{backgroundImage:"url("+(t.image||i("61b0")("./"+t.id+".png"))+")"}}):e._e()])}))],2),o("ul",{staticClass:"other"},[o("li",{staticClass:"headline"},[e._v("Other Nights")]),e._l(e.rolesOtherNight,(function(t){return o("li",{key:t.id,class:[t.team]},[t.id?o("span",{staticClass:"icon",style:{backgroundImage:"url("+(t.image||i("61b0")("./"+t.id+".png"))+")"}}):e._e(),o("span",{staticClass:"name"},[e._v(" "+e._s(t.name)+" ")])])}))],2)])],1):e._e()},He=[],Ze={components:{Modal:I},data:function(){return{roleSelection:{}}},computed:{editionName:function(){const e=ve.find(({id:e})=>e===this.edition);return e?e.name:"Custom Script"},rolesFirstNight:function(){const e=[];return this.roles.forEach(t=>{t.firstNight&&e.push(t)}),e.sort((e,t)=>e.firstNight-t.firstNight),e},rolesOtherNight:function(){const e=[];return this.roles.forEach(t=>{t.otherNight&&e.push(t)}),e.sort((e,t)=>e.otherNight-t.otherNight),e},...Object(r["d"])(["roles","modals","edition"]),...Object(r["d"])("players",["players"])},methods:{...Object(r["c"])(["toggleModal"])}},Ke=Ze,Qe=(i("130a"),Object(f["a"])(Ke,qe,He,!1,null,"30bec4b9",null)),Xe=Qe.exports,et=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Modal",{directives:[{name:"show",rawName:"v-show",value:e.modals.fabled&&e.fabled.length,expression:"modals.fabled && fabled.length"}],on:{close:function(t){return e.toggleModal("fabled")}}},[i("h3",[e._v(" Choose a fabled character to add to the game ")]),i("ul",{staticClass:"tokens"},e._l(e.fabled,(function(t){return i("li",{key:t.id,on:{click:function(i){return e.setFabled(t)}}},[i("Token",{attrs:{role:t}})],1)})),0)])},tt=[],it={components:{Token:b,Modal:I},computed:{...Object(r["d"])(["modals","fabled","grimoire"]),fabled(){const e=[];return this.$store.state.fabled.forEach(t=>{this.$store.state.grimoire.fabled.some(e=>e.id===t.id)||e.push(t)}),e}},methods:{setFabled(e){this.$store.commit("setFabled",{fabled:e}),this.$store.commit("toggleModal","fabled")},...Object(r["c"])(["toggleModal"])}},ot=it,st=(i("ef58"),Object(f["a"])(ot,et,tt,!1,null,"33f1756a",null)),at=st.exports,rt={components:{FabledModal:at,NightOrderModal:Xe,Vote:Fe,ReferenceModal:je,Intro:Oe,TownInfo:K,TownSquare:z,Menu:he,EditionModal:_e,RolesModal:fe,Gradients:Je},computed:{...Object(r["d"])(["grimoire","session"]),...Object(r["d"])("players",["players"])},data(){return{version:n["a"]}},methods:{takeScreenshot(e){this.$refs.menu.takeScreenshot(e)},keyup({key:e,ctrlKey:t,metaKey:i}){if(!t&&!i)switch(e.toLocaleLowerCase()){case"g":this.$store.commit("toggleGrimoire");break;case"a":this.$refs.menu.addPlayer();break;case"h":this.$refs.menu.hostSession();break;case"j":this.$refs.menu.joinSession();break;case"r":this.$store.commit("toggleModal","reference");break;case"n":this.$store.commit("toggleModal","nightOrder");break;case"e":if(this.session.isSpectator)return;this.$store.commit("toggleModal","edition");break;case"c":if(this.session.isSpectator)return;this.$store.commit("toggleModal","roles");break;case"escape":this.$store.commit("toggleModal")}}}},nt=rt,lt=(i("5c0b"),Object(f["a"])(nt,s,a,!1,null,null,null)),ht=lt.exports,ct=i("dfb1"),dt=i.n(ct),mt=i("b1d9");class pt{constructor(e){this._wss="wss://baumgart.biz:8080/",this._socket=null,this._isSpectator=!0,this._gamestate=[],this._store=e,this._pingInterval=3e4,this._pingTimer=null,this._players={},this._pings={},this._store.state.session.sessionId&&this.connect(this._store.state.session.sessionId)}_open(e){this.disconnect(),this._socket=new WebSocket(this._wss+e),this._socket.addEventListener("message",this._handleMessage.bind(this)),this._socket.onopen=this._onOpen.bind(this),this._socket.onclose=()=>{this._socket=null,this._store.commit("session/setSessionId",""),clearInterval(this._pingTimer),this._pingTimer=null}}_send(e,t){this._socket&&1===this._socket.readyState&&this._socket.send(JSON.stringify([e,t]))}_onOpen(){this._isSpectator?this._send("req","gs"):this.sendGamestate(),this._ping()}_ping(){this._send("ping",[this._isSpectator,this._store.state.session.playerId,(new Date).getTime()]),this._handlePing(),clearTimeout(this._pingTimer),this._pingTimer=setTimeout(this._ping.bind(this),this._pingInterval)}_handleMessage({data:e}){let t,i;try{[t,i]=JSON.parse(e)}catch(o){console.log("unsupported socket message",e)}switch(t){case"req":"gs"===i&&this.sendGamestate();break;case"edition":this._updateEdition(i);break;case"fabled":this._updateFabled(i);break;case"gs":this._updateGamestate(i);break;case"player":this._updatePlayer(i);break;case"claim":this._updateSeat(i);break;case"ping":this._handlePing(i);break;case"nomination":if(!this._isSpectator)return;this._store.commit("session/nomination",{nomination:i});break;case"swap":if(!this._isSpectator)return;this._store.commit("players/swap",i);break;case"move":if(!this._isSpectator)return;this._store.commit("players/move",i);break;case"votingSpeed":if(!this._isSpectator)return;this._store.commit("session/setVotingSpeed",i);break;case"vote":this._handleVote(i);break;case"lock":this._handleLock(i);break;case"bye":this._handleBye(i);break}}connect(e){this._store.state.session.playerId||this._store.commit("session/setPlayerId",Math.random().toString(36).substr(2)),this._pings={},this._store.commit("session/setPlayerCount",0),this._store.commit("session/setPing",0),this._isSpectator=this._store.state.session.isSpectator,this._open(e)}disconnect(){this._pings={},this._store.commit("session/setPlayerCount",0),this._store.commit("session/setPing",0),this._socket&&(this._send("bye",this._store.state.session.playerId),this._socket.close(),this._socket=null)}sendGamestate(){if(this._isSpectator)return;this._gamestate=this._store.state.players.players.map(e=>({name:e.name,id:e.id,isDead:e.isDead,isVoteless:e.isVoteless,...e.role&&"traveler"===e.role.team?{roleId:e.role.id}:{}}));const{session:e}=this._store.state;this.sendEdition(),this.sendFabled(),this._send("gs",{gamestate:this._gamestate,nomination:e.nomination,votingSpeed:e.votingSpeed,lockedVote:e.lockedVote,...e.nomination?{votes:e.votes}:{}})}_updateGamestate(e){if(!this._isSpectator)return;const{gamestate:t,nomination:i,votingSpeed:o,votes:s,lockedVote:a}=e;this._store.commit("session/nomination",{nomination:i,votes:s,votingSpeed:o,lockedVote:a});const r=this._store.state.players.players;if(r.length<t.length)for(let n=r.length;n<t.length;n++)this._store.commit("players/add",t[n].name);else if(r.length>t.length)for(let n=r.length;n>t.length;n--)this._store.commit("players/remove",n-1);t.forEach((e,t)=>{const i=r[t],{roleId:o}=e;if(["name","id","isDead","isVoteless"].forEach(t=>{const o=e[t];i[t]!==o&&this._store.commit("players/update",{player:i,property:t,value:o})}),o&&i.role.id!==o){const e=mt.find(e=>e.id===o);this._store.commit("players/update",{player:i,property:"role",value:e})}else o||"traveler"!==i.role.team||this._store.commit("players/update",{player:i,property:"role",value:{}})})}sendEdition(){if(this._isSpectator)return;const{edition:e}=this._store.state;let t;"custom"===e&&(t=this._store.getters.customRoles),this._send("edition",{edition:e,...t?{roles:t}:{}})}_updateEdition({edition:e,roles:t}){this._isSpectator&&(this._store.commit("setEdition",e),t&&this._store.commit("setCustomRoles",t))}sendFabled(){if(this._isSpectator)return;const{fabled:e}=this._store.state.grimoire;this._send("fabled",e.map(({id:e})=>e))}_updateFabled(e){this._isSpectator&&this._store.commit("setFabled",{fabled:e.map(e=>this._store.state.fabled.get(e))})}sendPlayer({player:e,property:t,value:i}){if(this._isSpectator||"reminders"===t)return;const o=this._store.state.players.players.indexOf(e);"role"===t?i.team&&"traveler"===i.team?(this._gamestate[o].roleId=i.id,this._send("player",{index:o,property:t,value:i.id})):this._gamestate[o].roleId&&(delete this._gamestate[o].roleId,this._send("player",{index:o,property:t,value:""})):this._send("player",{index:o,property:t,value:i})}_updatePlayer({index:e,property:t,value:i}){const o=this._store.state.players.players[e];if(o)if("role"===t)if(i||"traveler"!==o.role.team){const e=mt.find(e=>e.id===i);this._store.commit("players/update",{player:o,property:"role",value:e})}else this._store.commit("players/update",{player:o,property:"role",value:{}});else this._store.commit("players/update",{player:o,property:t,value:i})}_handlePing([e,t,i]=[]){const o=(new Date).getTime();for(let s in this._players)o-this._players[s]>2*this._pingInterval&&(delete this._players[s],delete this._pings[s]);if(this._store.state.players.players.forEach(e=>{this._isSpectator||!e.id||this._players[e.id]||this._store.commit("players/update",{player:e,property:"id",value:""})}),t)if(this._players[t]=o,this._isSpectator||e)if(this._isSpectator&&!e)this._store.commit("session/setPing",o-i);else{this._pings[t]=o-i;const e=Object.values(this._pings);this._store.commit("session/setPing",Math.round(e.reduce((e,t)=>e+t,0)/e.length))}else alert("Another storyteller joined the session!");this._store.commit("session/setPlayerCount",Object.keys(this._players).length)}_handleBye(e){delete this._players[e],this._store.commit("session/setPlayerCount",Object.keys(this._players).length)}claimSeat(e){this._isSpectator&&this._store.state.players.players.length>e&&this._send("claim",[e,this._store.state.session.playerId])}_updateSeat([e,t]){if(this._isSpectator)return;const i="id",o=this._store.state.players.players,s=o.findIndex(({id:e})=>e===t);if(s>=0&&s!==e&&this._store.commit("players/update",{player:o[s],property:i,value:""}),e>=0){const s=o[e];if(!s)return;this._store.commit("players/update",{player:s,property:i,value:t})}this._handlePing([!0,t])}nomination({nomination:e}={}){if(this._isSpectator)return;const t=this._store.state.players.players;(!e||t.length>e[0]&&t.length>e[1])&&(this.setVotingSpeed(this._store.state.session.votingSpeed),this._send("nomination",e))}setVotingSpeed(e){this._isSpectator||e&&this._send("votingSpeed",e)}vote([e]){const t=this._store.state.players.players[e];this._store.state.session.playerId!==t.id&&this._isSpectator||this._send("vote",[e,this._store.state.session.votes[e],!this._isSpectator])}_handleVote([e,t,i]){const{session:o,players:s}=this._store.state,a=s.players.length,r=(e-1+a-o.nomination[1])%a;(i||r>=o.lockedVote-1)&&this._store.commit("session/vote",[e,t])}lockVote(){if(this._isSpectator)return;const{lockedVote:e,votes:t,nomination:i}=this._store.state.session,{players:o}=this._store.state.players,s=(i[1]+e-1)%o.length;this._send("lock",[this._store.state.session.lockedVote,t[s]])}_handleLock([e,t]){if(this._store.commit("session/lockVote",e),e>1){const{lockedVote:e,nomination:i}=this._store.state.session,{players:o}=this._store.state.players,s=(i[1]+e-1)%o.length;this._store.state.session.votes[s]!==t&&this._store.commit("session/vote",[s,t])}}swapPlayer(e){this._isSpectator||this._send("swap",e)}movePlayer(e){this._isSpectator||this._send("move",e)}}var gt=e=>{const t=new pt(e);e.subscribe(({type:e,payload:i})=>{switch(e){case"session/setSessionId":i?t.connect(i):(window.location.hash="",t.disconnect());break;case"session/claimSeat":t.claimSeat(i);break;case"session/nomination":t.nomination(i);break;case"session/voteSync":t.vote(i);break;case"session/lockVote":t.lockVote();break;case"session/setVotingSpeed":t.setVotingSpeed(i);break;case"setEdition":t.sendEdition();break;case"setFabled":t.sendFabled();break;case"players/swap":t.swapPlayer(i);break;case"players/move":t.movePlayer(i);break;case"players/set":case"players/clear":case"players/remove":case"players/add":t.sendGamestate();break;case"players/update":t.sendPlayer(i);break}});const[i,o]=window.location.hash.substr(1).split("/");"play"===i&&(e.commit("session/setSpectator",!0),e.commit("session/setSessionId",o))};const ut={name:"",id:"",role:{},reminders:[],isVoteless:!1,isDead:!1},ft=()=>({players:[]}),yt={alive({players:e}){return e.filter(e=>!e.isDead).length},nonTravelers({players:e}){const t=e.filter(e=>"traveler"!==e.role.team);return Math.min(t.length,15)},nightOrder({players:e}){const t=[0],i=[0];e.forEach(({role:e})=>{e.firstNight&&!t.includes(e.firstNight)&&t.push(e.firstNight),e.otherNight&&!i.includes(e.otherNight)&&i.push(e.otherNight)}),t.sort((e,t)=>e-t),i.sort((e,t)=>e-t);const o=new Map;return e.forEach(e=>{const s=Math.max(t.indexOf(e.role.firstNight),0),a=Math.max(i.indexOf(e.role.otherNight),0);o.set(e,{first:s,other:a})}),o}},bt={randomize({state:e,commit:t}){const i=e.players.map(e=>[Math.random(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1]);t("set",i)},clearRoles({state:e,commit:t,rootState:i}){let o;o=i.session.isSpectator?e.players.map(e=>("traveler"!==e.role.team&&(e.role={}),e.reminders=[],e)):e.players.map(({name:e,id:t})=>({...ut,name:e,id:t})),t("set",o)}},vt={clear(e){e.players=[]},set(e,t=[]){e.players=t},update(e,{player:t,property:i,value:o}){const s=e.players.indexOf(t);s>=0&&(e.players[s][i]=o)},add(e,t){e.players.push({...ut,name:t})},remove(e,t){e.players.splice(t,1)},swap(e,[t,i]){[e.players[t],e.players[i]]=[e.players[i],e.players[t]],e.players.splice(0,0)},move(e,[t,i]){e.players.splice(i,0,e.players.splice(t,1)[0])}};var kt={namespaced:!0,state:ft,getters:yt,actions:bt,mutations:vt};const wt=e=>(t,i)=>{t[e]=i},Nt=(e,[t,i])=>{e.nomination&&(e.votes=[...e.votes],e.votes[t]=void 0===i?!e.votes[t]:i)},_t=()=>({sessionId:"",isSpectator:!1,playerCount:0,ping:0,playerId:"",claimedSeat:-1,nomination:!1,votes:[],lockedVote:0,votingSpeed:3}),St={},Rt={},xt={setSessionId:wt("sessionId"),setPlayerId:wt("playerId"),setSpectator:wt("isSpectator"),setPlayerCount:wt("playerCount"),setPing:wt("ping"),setVotingSpeed:wt("votingSpeed"),claimSeat:wt("claimedSeat"),nomination(e,{nomination:t,votes:i,votingSpeed:o,lockedVote:s}={}){e.nomination=t||!1,e.votes=i||[],e.votingSpeed=o||e.votingSpeed,e.lockedVote=s||0},vote:Nt,voteSync:Nt,lockVote(e,t){e.lockedVote=void 0!==t?t:e.lockedVote+1}};var Tt={namespaced:!0,state:_t,getters:St,actions:Rt,mutations:xt},Ct=i("b249");o["a"].use(r["a"]);const Ot=new Map(mt.map(e=>[e.id,e])),It=new Map(Ct.map(e=>[e.id,e])),Mt=(e="tb")=>{const t=ve.find(({id:t})=>t===e)||ve[0];return new Map(mt.filter(i=>i.edition===e||t.roles.includes(i.id)).sort((e,t)=>t.team.localeCompare(e.team)).map(e=>[e.id,e]))},Pt="https://raw.githubusercontent.com/bra1n/townsquare/main/src/assets/icons/",Dt={image:"",edition:"custom",firstNight:0,firstNightReminder:"",otherNight:0,otherNightReminder:"",reminders:[],remindersGlobal:[],setup:!1,team:"townsfolk",isCustom:!0};var Et=new r["a"].Store({modules:{players:kt,session:Tt},state:{grimoire:{isNightOrder:!0,isPublic:!0,isMenuOpen:!1,isScreenshot:!1,isScreenshotSuccess:!1,zoom:0,background:"",bluffs:[],fabled:[]},modals:{edition:!1,fabled:!1,nightOrder:!1,reference:!1,reminder:!1,role:!1,roles:!1},edition:"tb",roles:Mt(),fabled:It},getters:{customRoles:({roles:e})=>{const t=[];return e.forEach(e=>{if(e.isCustom){const i={};for(let t in e){const o=e[t];"image"===t&&o.match(new RegExp("^"+Pt))||"isCustom"!==t&&o!==Dt[t]&&(i[t]=o)}t.push(i)}else t.push({id:e.id})}),t}},mutations:{toggleMenu({grimoire:e}){e.isMenuOpen=!e.isMenuOpen},toggleGrimoire({grimoire:e},t){e.isPublic=!0===t||!1===t?t:!e.isPublic,document.title="Blood on the Clocktower "+(e.isPublic?"Town Square":"Grimoire")},toggleNightOrder({grimoire:e}){e.isNightOrder=!e.isNightOrder},setZoom({grimoire:e},t){e.zoom=t},setBackground({grimoire:e},t){e.background=t},setBluff({grimoire:e},{index:t,role:i}={}){void 0!==t?e.bluffs.splice(t,1,i):e.bluffs=[]},setFabled({grimoire:e},{index:t,fabled:i}={}){void 0!==t?e.fabled.splice(t,1):i&&(Array.isArray(i)?e.fabled=i:e.fabled.push(i))},toggleModal({modals:e},t){t&&(e[t]=!e[t]);for(let i in e)i!==t&&(e[i]=!1)},updateScreenshot({grimoire:e},t){!0!==t&&!1!==t?(e.isScreenshotSuccess=!1,e.isScreenshot=!0):(e.isScreenshotSuccess=t,e.isScreenshot=!1)},setCustomRoles(e,t){e.roles=new Map(t.map(e=>Ot.get(e.id)||Object.assign({},Dt,e)).map(e=>(Ot.get(e.id)||("townsfolk"===e.team||"outsider"===e.team?e.image=e.image||Pt+"good.png":"demon"===e.team||"minion"===e.team?e.image=e.image||Pt+"evil.png":e.image=e.image||Pt+"custom.png"),e)).filter(e=>e.name&&e.ability&&e.team).sort((e,t)=>t.team.localeCompare(e.team)).map(e=>[e.id,e]))},setEdition(e,t){e.edition=t,e.modals.edition=!1,"custom"!==t&&(e.roles=Mt(t))}},plugins:[dt.a,gt]}),jt=i("ecee"),$t=i("c074"),Vt=i("f2d1"),At=i("ad3d");const Bt=["AddressCard","BookOpen","BroadcastTower","Camera","Chair","CheckSquare","CloudMoon","Cog","Copy","Dice","Dragon","ExchangeAlt","FileUpload","HandPointRight","Heartbeat","Image","Link","MinusCircle","PeopleArrows","PlusCircle","Question","Random","RedoAlt","SearchMinus","SearchPlus","Skull","Square","TheaterMasks","Times","TimesCircle","TrashAlt","Undo","User","UserEdit","UserFriends","Users","VoteYea"],Gt=["Github","Discord"];jt["c"].add(...Bt.map(e=>$t["a"]["fa"+e]),...Gt.map(e=>Vt["a"]["fa"+e])),o["a"].component("font-awesome-icon",At["a"]),o["a"].config.productionTip=!1,new o["a"]({render:e=>e(ht),store:Et}).$mount("#app")},"5bd9":function(e,t,i){e.exports=i.p+"img/cannibal.e2bfb541.png"},"5c0b":function(e,t,i){"use strict";var o=i("9c0c"),s=i.n(o);s.a},"5c56":function(e,t,i){e.exports=i.p+"img/duchess.cfec75dc.png"},"5c8e":function(e,t,i){e.exports=i.p+"img/goblin.7ebbd9ad.png"},"5cf2":function(e,t,i){e.exports=i.p+"img/x.fbca4d75.png"},"5de9":function(e,t,i){"use strict";var o=i("93e2"),s=i.n(o);s.a},"61b0":function(e,t,i){var o={"./acrobat.png":"887b","./amnesiac.png":"043b","./angel.png":"bfe2","./apprentice.png":"4bea","./artist.png":"2cd0","./assassin.png":"9187","./balloonist.png":"65db","./barber.png":"fcc6","./barista.png":"027a","./baron.png":"24d3","./beggar.png":"cfcc","./bishop.png":"8030","./bonecollector.png":"23b1","./bountyhunter.png":"899d","./buddhist.png":"1d01","./bureaucrat.png":"25f6","./butcher.png":"37dd","./butler.png":"64fe","./cannibal.png":"5bd9","./cerenovus.png":"0436","./chambermaid.png":"125e","./chef.png":"1e83","./clockmaker.png":"f93f","./courtier.png":"ee02","./cultleader.png":"398f","./custom.png":"fd83","./deviant.png":"3b65","./devilsadvocate.png":"cd8b","./djinn.png":"e222","./doomsayer.png":"659f","./dreamer.png":"71b8","./drunk.png":"d97d","./duchess.png":"5c56","./empath.png":"bb7a","./evil.png":"c24f","./eviltwin.png":"e014","./exorcist.png":"5072","./fanggu.png":"6ac0","./fibbin.png":"6eb1","./fiddler.png":"64be","./fisherman.png":"c5db","./flowergirl.png":"66ae","./fool.png":"4720","./fortuneteller.png":"43e8","./gambler.png":"dce6","./goblin.png":"5c8e","./godfather.png":"99d0","./good.png":"667e","./goon.png":"55aa","./gossip.png":"cadc","./grandmother.png":"c9f5","./gunslinger.png":"ee92","./harlot.png":"559e","./hellslibrarian.png":"a367","./imp.png":"3e70","./innkeeper.png":"663c","./investigator.png":"b570","./judge.png":"f09b","./juggler.png":"65ab","./klutz.png":"adfc","./leviathan.png":"2b04","./librarian.png":"4d73","./lilmonsta.png":"c492","./lunatic.png":"0b61","./mastermind.png":"f834","./mathematician.png":"8888","./matron.png":"b1cb","./mayor.png":"b223","./minstrel.png":"4efd","./monk.png":"6741","./moonchild.png":"3f65","./mutant.png":"17ad","./nodashii.png":"68a4","./oracle.png":"0c12","./pacifist.png":"fff1","./philosopher.png":"3603","./pithag.png":"7f07","./plus.png":"160b","./po.png":"c73a","./poisoner.png":"f282","./politician.png":"07ab","./preacher.png":"2094","./professor.png":"b30c","./pukka.png":"a6a2","./ravenkeeper.png":"0c59","./recluse.png":"177d","./revolutionary.png":"aa2d","./sage.png":"30b6","./sailor.png":"223c","./saint.png":"6936","./savant.png":"d715","./scapegoat.png":"327a","./scarletwoman.png":"f322","./seamstress.png":"ac7c","./sentinel.png":"af68","./shabaloth.png":"0b29","./slayer.png":"d62b","./snakecharmer.png":"4021","./soldier.png":"4e76","./spiritofivory.png":"0d06","./spy.png":"ec1e","./sweetheart.png":"f1e5","./tealady.png":"ba9b","./thief.png":"9ce3","./tinker.png":"9f7e","./towncrier.png":"38a5","./toymaker.png":"39eb","./undertaker.png":"0e20","./vigormortis.png":"f4bd","./virgin.png":"eff4","./vortox.png":"3a43","./voudon.png":"a710","./washerwoman.png":"013f","./widow.png":"22c9","./witch.png":"f558","./x.png":"5cf2","./zombuul.png":"20ca"};function s(e){var t=a(e);return i(t)}function a(e){if(!i.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}s.keys=function(){return Object.keys(o)},s.resolve=a,e.exports=s,s.id="61b0"},"634a":function(e){e.exports=JSON.parse('[{"townsfolk":3,"outsider":0,"minion":1,"demon":1},{"townsfolk":3,"outsider":1,"minion":1,"demon":1},{"townsfolk":5,"outsider":0,"minion":1,"demon":1},{"townsfolk":5,"outsider":1,"minion":1,"demon":1},{"townsfolk":5,"outsider":2,"minion":1,"demon":1},{"townsfolk":7,"outsider":0,"minion":2,"demon":1},{"townsfolk":7,"outsider":1,"minion":2,"demon":1},{"townsfolk":7,"outsider":2,"minion":2,"demon":1},{"townsfolk":9,"outsider":0,"minion":3,"demon":1},{"townsfolk":9,"outsider":1,"minion":3,"demon":1},{"townsfolk":9,"outsider":2,"minion":3,"demon":1}]')},"64be":function(e,t,i){e.exports=i.p+"img/fiddler.8c3b1cc0.png"},"64fe":function(e,t,i){e.exports=i.p+"img/butler.3763fa3d.png"},"659f":function(e,t,i){e.exports=i.p+"img/doomsayer.34573e9a.png"},"65ab":function(e,t,i){e.exports=i.p+"img/juggler.7cc6d089.png"},"65db":function(e,t,i){e.exports=i.p+"img/balloonist.3d6e31f8.png"},"663c":function(e,t,i){e.exports=i.p+"img/innkeeper.8b0b87f1.png"},"667e":function(e,t,i){e.exports=i.p+"img/good.9b3436c8.png"},"66ae":function(e,t,i){e.exports=i.p+"img/flowergirl.4ee69cb5.png"},6741:function(e,t,i){e.exports=i.p+"img/monk.a6f2667a.png"},"68a4":function(e,t,i){e.exports=i.p+"img/nodashii.5c943357.png"},6936:function(e,t,i){e.exports=i.p+"img/saint.f81db252.png"},"6ac0":function(e,t,i){e.exports=i.p+"img/fanggu.cb4e346c.png"},"6b1e":function(e,t,i){},"6e24":function(e,t,i){},"6eb1":function(e,t,i){e.exports=i.p+"img/fibbin.2c83b0c2.png"},"71b8":function(e,t,i){e.exports=i.p+"img/dreamer.ab7f2328.png"},"74c9":function(e,t,i){"use strict";var o=i("9fd8"),s=i.n(o);s.a},"7f07":function(e,t,i){e.exports=i.p+"img/pithag.adc1ce12.png"},8030:function(e,t,i){e.exports=i.p+"img/bishop.dec14fdc.png"},8527:function(e,t,i){"use strict";var o=i("1c9f"),s=i.n(o);s.a},8781:function(e,t,i){"use strict";var o=i("6b1e"),s=i.n(o);s.a},"887b":function(e,t,i){e.exports=i.p+"img/acrobat.b8ef8f5b.png"},8888:function(e,t,i){e.exports=i.p+"img/mathematician.31142ad1.png"},"899d":function(e,t,i){e.exports=i.p+"img/bountyhunter.cc6eb160.png"},9187:function(e,t,i){e.exports=i.p+"img/assassin.db54a5ff.png"},9224:function(e){e.exports=JSON.parse('{"a":"1.7.3"}')},"93e2":function(e,t,i){},"98c6":function(e,t,i){"use strict";var o=i("ab42"),s=i.n(o);s.a},"99d0":function(e,t,i){e.exports=i.p+"img/godfather.2febcd81.png"},"9c0c":function(e,t,i){},"9ce3":function(e,t,i){e.exports=i.p+"img/thief.60ce8845.png"},"9f7d":function(e,t,i){},"9f7e":function(e,t,i){e.exports=i.p+"img/tinker.669b5612.png"},"9fd8":function(e,t,i){},a367:function(e,t,i){e.exports=i.p+"img/hellslibrarian.ed49edab.png"},a6a2:function(e,t,i){e.exports=i.p+"img/pukka.cbbc2d26.png"},a710:function(e,t,i){e.exports=i.p+"img/voudon.2b1f0492.png"},aa2d:function(e,t,i){e.exports=i.p+"img/revolutionary.ae2abbef.png"},ab42:function(e,t,i){},ac7c:function(e,t,i){e.exports=i.p+"img/seamstress.05f0eb74.png"},adfc:function(e,t,i){e.exports=i.p+"img/klutz.c7e784cd.png"},af68:function(e,t,i){e.exports=i.p+"img/sentinel.1fecd38b.png"},b097:function(e,t,i){},b1cb:function(e,t,i){e.exports=i.p+"img/matron.ffb17746.png"},b1d9:function(e){e.exports=JSON.parse('[{"id":"washerwoman","name":"Washerwoman","edition":"tb","team":"townsfolk","firstNight":15,"firstNightReminder":":eye: Show the character token of a Townsfolk in play. Point to two players, one of which is that character. :eye-slash:","otherNight":0,"otherNightReminder":"","reminders":["Townsfolk","Decoy"],"setup":false,"ability":"You start knowing 1 of 2 players is a particular Townsfolk."},{"id":"librarian","name":"Librarian","edition":"tb","team":"townsfolk","firstNight":16,"firstNightReminder":":eye: Show the character token of a Outsider in play. Point to two players, one of which is that character. :eye-slash:","otherNight":0,"otherNightReminder":"","reminders":["Outsider","Decoy"],"setup":false,"ability":"You start knowing that 1 of 2 players is a particular Outsider. (Or that zero are in play)"},{"id":"investigator","name":"Investigator","edition":"tb","team":"townsfolk","firstNight":17,"firstNightReminder":":eye: Show the character token of a Minion in play. Point to two players, one of which is that character. :eye-slash:","otherNight":0,"otherNightReminder":"","reminders":["Minion","Decoy"],"setup":false,"ability":"You start knowing 1 of 2 players is a particular Minion."},{"id":"chef","name":"Chef","edition":"tb","team":"townsfolk","firstNight":18,"firstNightReminder":":eye: Show the finger signal (0, 1, 2, …) for the number of pairs of neighbouring evil players. :eye-slash:","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"You start knowing how many pairs of evil players there are."},{"id":"empath","name":"Empath","edition":"tb","team":"townsfolk","firstNight":19,"firstNightReminder":":eye: Show the finger signal (0, 1, 2) for the number of evil alive neighbours of the Empath. :eye-slash:","otherNight":37,"otherNightReminder":":eye: Show the finger signal (0, 1, 2) for the number of evil neighbours. :eye-slash:","reminders":[],"setup":false,"ability":"Each night, you learn how many of your 2 alive neighbours are evil."},{"id":"fortuneteller","name":"Fortune Teller","edition":"tb","team":"townsfolk","firstNight":20,"firstNightReminder":":eye: The Fortune Teller points to two players. Give the head signal (nod yes, shake no) for whether one of those players is the Demon. :eye-slash:","otherNight":38,"otherNightReminder":":eye: The Fortune Teller points to two players. Show the head signal (nod “yes”, shake “no”) for whether one of those players is the Demon. :eye-slash:","reminders":["Decoy"],"setup":false,"ability":"Each night, choose 2 players: you learn if either is a Demon. There is 1 good player that registers falsely to you."},{"id":"undertaker","name":"Undertaker","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":40,"otherNightReminder":":question-circle: If a player was executed today: :eye: Show that player’s character token. :eye-slash:","reminders":["Executed"],"setup":false,"ability":"Each night*, you learn which character died by execution today."},{"id":"monk","name":"Monk","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":8,"otherNightReminder":"The previously protected player is no longer protected. :plus-circle: :eye: The Monk points to a player not themself. :eye-slash: Mark that player “Protected”. :plus-circle:","reminders":["Protected"],"setup":false,"ability":"Each night*, choose a player (not yourself): they are safe from the Demon tonight."},{"id":"ravenkeeper","name":"Ravenkeeper","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":35,"otherNightReminder":":question-circle: If the Ravenkeeper died tonight: :eye: The Ravenkeeper points to a player. Show that player’s character token. :eye-slash:","reminders":[],"setup":false,"ability":"If you die at night, you are woken to choose a player: you learn their character."},{"id":"mayor","name":"Mayor","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"If only 3 players live and no execution occurs, your team wins. If you die at night, another player might die instead."},{"id":"slayer","name":"Slayer","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"ability":"Once per game, during the day, publicly choose a player: if they are the Demon, they die."},{"id":"soldier","name":"Soldier","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"You are safe from the Demon."},{"id":"virgin","name":"Virgin","edition":"tb","team":"townsfolk","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"ability":"The first time you are nominated, if the nominator is a Townsfolk, they are executed immediately."},{"id":"butler","name":"Butler","edition":"tb","team":"outsider","firstNight":21,"firstNightReminder":":eye: The Butler points to a player. :eye-slash: Mark that player as “Master”. :plus-circle:","otherNight":39,"otherNightReminder":":eye: The Butler points to a player. :eye-slash: Mark that player as “Master”. :plus-circle:","reminders":["Master"],"setup":false,"ability":"Each night, choose a player (not yourself): tomorrow, you may only vote if they are voting too."},{"id":"drunk","name":"Drunk","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"remindersGlobal":["Drunk"],"setup":true,"ability":"You do not know you are the Drunk. You think you are a Townsfolk, but your ability malfunctions."},{"id":"recluse","name":"Recluse","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"You might register as evil and as a Minion or Demon, even if dead."},{"id":"saint","name":"Saint","edition":"tb","team":"outsider","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"ability":"If you die by execution, your team loses."},{"id":"baron","name":"Baron","edition":"tb","team":"minion","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":true,"ability":"There are extra Outsiders in play. [+2 Outsiders]"},{"id":"poisoner","name":"Poisoner","edition":"tb","team":"minion","firstNight":4,"firstNightReminder":":eye: The Poisoner points to a player. :eye-slash: That player is poisoned. :plus-circle:","otherNight":3,"otherNightReminder":"The previously poisoned player is no longer poisoned. :plus-circle: :eye: The Poisoner points to a player. :eye-slash: That player is poisoned. :plus-circle:","reminders":["Poisoned"],"setup":false,"ability":"Each night, choose a player: their ability malfunctions tonight and tomorrow day."},{"id":"spy","name":"Spy","edition":"tb","team":"minion","firstNight":26,"firstNightReminder":":eye: Show the Grimoire to the Spy for as long as they need. :eye-slash:","otherNight":47,"otherNightReminder":":eye: Show the Grimoire to the Spy for as long as they need. :eye-slash:","reminders":[],"setup":false,"ability":"Each night, you see the Grimoire. You might register as good and as a Townsfolk or Outsider, even if dead."},{"id":"scarletwoman","name":"Scarlet Woman","edition":"tb","team":"minion","firstNight":0,"firstNightReminder":"","otherNight":13,"otherNightReminder":":question-circle: If the Scarlet Woman became the Demon today: :eye: Show the “You are” card, then the demon token. :eye-slash:","reminders":["Demon"],"setup":false,"ability":"If there are 5 or more players alive (Travelers don\'t count) and the Demon dies, you become the Demon."},{"id":"imp","name":"Imp","edition":"tb","team":"demon","firstNight":0,"firstNightReminder":"","otherNight":18,"otherNightReminder":":eye: The Imp points to a player. :eye-slash: That player dies. :plus-circle: If the Imp chose themself: • Replace the character of 1 alive minion with a spare Imp token. :plus-circle: • :eye: Wake the new Imp. Show the “You are” card, then the Imp token. :eye-slash:","reminders":["Die"],"setup":false,"ability":"Each night*, choose a player: they die. If you kill yourself this way, a Minion becomes the Imp."},{"id":"grandmother","edition":"bmr","firstNight":22,"firstNightReminder":"Show the marked character token. Point to the marked player.","otherNight":31,"otherNightReminder":"If the Grandmother’s grandchild was killed by the Demon tonight: • The Grandmother dies.","reminders":["Grandchild"],"setup":false,"name":"Grandmother","team":"townsfolk","ability":"You start knowing a good player and character. If the Demon kills them, you die too."},{"id":"sailor","edition":"bmr","firstNight":3,"firstNightReminder":"The Sailor points to a living player. Either the Sailor, or the chosen player, is drunk.","otherNight":2,"otherNightReminder":"The previously drunk player is no longer drunk. The Sailor points to a living player. Either the Sailor, or the chosen player, is drunk.","reminders":["Drunk"],"setup":false,"name":"Sailor","team":"townsfolk","ability":"Each night, choose a player: either you or they are drunk until dusk. You can not die."},{"id":"chambermaid","edition":"bmr","firstNight":28,"firstNightReminder":"The Chambermaid points to two players. Show the number signal (0, 1, 2, …) for how many of those players wake tonight for their ability.","otherNight":49,"otherNightReminder":"The Chambermaid points to two players. Show the number signal (0, 1, 2) for how many of those players wake tonight for their ability.","reminders":[],"setup":false,"name":"Chambermaid","team":"townsfolk","ability":"Each night, choose 2 alive players (not yourself): you learn how many woke tonight due to their ability."},{"id":"exorcist","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":16,"otherNightReminder":"The Exorcist points to a player, different from the previous night. If that player is the Demon: • Wake the Demon. Show the Exorcist token. Point to the Exorcist. • The Demon does not act tonight.","reminders":["Chosen"],"setup":false,"name":"Exorcist","team":"townsfolk","ability":"Each night*, choose a player (not the same as last night): the Demon, if chosen, learns who you are and does not act tonight."},{"id":"innkeeper","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":5,"otherNightReminder":"The previously protected and drunk players lose those markers. The Innkeeper points to two players. Those players are protected. One is drunk.","reminders":["Protected","Drunk"],"setup":false,"name":"Innkeeper","team":"townsfolk","ability":"Each night*, choose 2 players: they cannot die tonight, but 1 is drunk until dusk."},{"id":"gambler","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":14,"otherNightReminder":"The Gambler points to a player, and a character on their sheet. If incorrect, the Gambler dies.","reminders":["Die"],"setup":false,"name":"Gambler","team":"townsfolk","ability":"Each night*, choose a player and guess their character: if you guess wrong, you die."},{"id":"gossip","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":28,"otherNightReminder":"If the Gossip’s public statement was true: • Choose a player not protected from dying tonight. That player dies.","reminders":["Die"],"setup":false,"name":"Gossip","team":"townsfolk","ability":"Each day, you may make a public statement. Tonight, if it was true, a player dies."},{"id":"courtier","edition":"bmr","firstNight":7,"firstNightReminder":"The Courier either shows a “no” head signal, or points to a character on the sheet. If the Courtier used their ability : If that character is in play, that player is drunk.","otherNight":6,"otherNightReminder":"Reduce the remaining number of days the marked player is poisoned. If the Courtier has not yet used their ability: • The Courier either shows a “no” head signal, or points to a character on the sheet. • If the Courtier used their ability : If that character is in play, that player is drunk.","reminders":["Drunk 1","Drunk 2","Drunk 3","Used"],"setup":false,"name":"Courtier","team":"townsfolk","ability":"Once per game, at night, choose a character: they are drunk for 3 nights and 3 days."},{"id":"professor","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":34,"otherNightReminder":"If the Professor has not used their ability: • The Professor either shows the “no” head signal, or points to a player. • If that player is a Townsfolk, they are now alive.","reminders":["Alive","Used"],"setup":false,"name":"Professor","team":"townsfolk","ability":"Once per game, at night*, choose a dead player. If they are a Townsfolk, they are resurrected."},{"id":"minstrel","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":1,"otherNightReminder":"Remove the “Everyone drunk” marker. If a Minion died today: All players but the Minstrel are drunk. Place the “Everyone drunk” marker.","reminders":["Everyone drunk"],"setup":false,"name":"Minstrel","team":"townsfolk","ability":"If a Minion died today, all other players (except Travelers) are drunk all night, until dusk."},{"id":"tealady","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Protected"],"setup":false,"name":"Tea Lady","team":"townsfolk","ability":"If both your alive neighbors are good, they can not die."},{"id":"pacifist","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Pacifist","team":"townsfolk","ability":"Executed good players might not die."},{"id":"fool","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Fool","team":"townsfolk","ability":"The first time you die, you don\'t."},{"id":"tinker","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":29,"otherNightReminder":"The Tinker might die.","reminders":["Die"],"setup":false,"name":"Tinker","team":"outsider","ability":"You might die at any time."},{"id":"moonchild","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":30,"otherNightReminder":"If the Moonchild used their ability to target a player today: • If that player is good, they die.","reminders":["Die"],"setup":false,"name":"Moonchild","team":"outsider","ability":"When you learn that you died, choose 1 alive player: if good, they die tonight."},{"id":"goon","edition":"bmr","firstNight":29,"firstNightReminder":"If a player used their character ability to choose the Goon: • The Goon becomes that player’s alignment. • Show the “You are” card. Show the hand signal (thumb-up “good”, thumb-down “evil”) for the Goon’s current alignment.","otherNight":50,"otherNightReminder":"If a player used their character ability to choose the Goon: • The Goon becomes that player’s alignment. • Show the “You are” card, then the hand signal (thumb-up “good”, thumb-down “evil”) for the Goon’s current alignment.","reminders":["Drunk"],"setup":false,"name":"Goon","team":"outsider","ability":"Each night, the 1st player to choose you with their ability is drunk until dusk. You become their alignment."},{"id":"lunatic","edition":"bmr","firstNight":1,"firstNightReminder":"If 7 or more players: Show the Lunatic a number of arbitrary “Minion“, players equal to the number of Minions in play. Show 3 character tokens of arbitrary Good characters. If the token received by the Lunatic is a Demon that would wake tonight: • Allow the Lunatic to do the Demon actions. Place their “attack” markers. Wake the Demon. Show the Demon’s real character token. Show them the Lunatic player. • If the Lunatic attacked players: Show the real demon each marked player. Remove any Lunatic “attack” markers.","otherNight":15,"otherNightReminder":"Allow the Lunatic to do the actions of the Demon. Place their “attack” markers. If the Lunatic selected players: Wake the Demon. Show the “attack” marker, then point to each marked player. Remove any Lunatic “attack” markers.","reminders":["Attack 1","Attack 2","Attack 3","Decoy"],"setup":false,"name":"Lunatic","team":"outsider","ability":"You think you are a Demon, but your abilities malfunction. The Demon knows who you are and who you attack."},{"id":"godfather","edition":"bmr","firstNight":9,"firstNightReminder":"Show each of the Outsider tokens in play.","otherNight":32,"otherNightReminder":"If an Outsider died today: • The Godfather points to a player. That player dies.","reminders":["Died today","Die"],"setup":true,"name":"Godfather","team":"minion","ability":"You start knowing which Outsiders are in-play. If 1 died today, choose a player tonight: they die. [-1 or +1 Outsider]"},{"id":"devilsadvocate","edition":"bmr","firstNight":10,"firstNightReminder":"The Devil’s Advocate points to a living player. That player survives execution tomorrow.","otherNight":9,"otherNightReminder":"The Devil’s Advocate points to a living player, different from the previous night. That player survives execution tomorrow.","reminders":["Survives execution"],"setup":false,"name":"Devil\'s Advocate","team":"minion","ability":"Each night, choose a living player (not the same as last night): if executed tomorrow, they do not die."},{"id":"assassin","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":26,"otherNightReminder":"If the Assassin has not yet used their ability: • The Assassin either shows the “no” head signal, or points to a player. That player dies.","reminders":["Die","Used"],"setup":false,"name":"Assassin","team":"minion","ability":"Once per game, at night*, choose a player: they die, even if for some reason they could not."},{"id":"mastermind","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Mastermind","team":"minion","ability":"If the Demon dies by execution, play for 1 more day. If a player is then executed, their team loses."},{"id":"po","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":21,"otherNightReminder":"If the Po chose no-one the previous night : The Po points to three players . Otherwise: The Po either shows the “no” head signal , or points to a player . The marked players (if any) die.","reminders":["Die 1","Die 2","Die 3","Attack x3"],"setup":false,"name":"Po","team":"demon","ability":"Each night*, you may choose a player: they die. If you chose no-one last night, choose 3 players tonight."},{"id":"zombuul","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":19,"otherNightReminder":"If no-one died during the day: • The Zombuul points to a player. That player dies.","reminders":["No death today","Die"],"setup":false,"name":"Zombuul","team":"demon","ability":"Each night*, if no-one died today, choose a player: they die. The 1st time you die, you live but register as dead."},{"id":"pukka","edition":"bmr","firstNight":14,"firstNightReminder":"The Pukka points to a player. That player is poisoned.","otherNight":17,"otherNightReminder":"The poisoned player dies. The Pukka points to a player. That player is poisoned.","reminders":["Poisoned","Die"],"setup":false,"name":"Pukka","team":"demon","ability":"Each night, choose a player: they are poisoned until tomorrow night, then die. You act on the 1st night."},{"id":"shabaloth","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":20,"otherNightReminder":"One player that the Shabaloth chose the previous night might come alive. The Shabaloth points to two players. Those players die.","reminders":["Die 1","Die 2","Alive"],"setup":false,"name":"Shabaloth","team":"demon","ability":"Each night*, choose 2 players: they die. A dead player you chose last night might be regurgitated."},{"id":"clockmaker","edition":"snv","firstNight":23,"firstNightReminder":"Show the hand signal for the number (1, 2, 3, etc.) of places from Demon to closest Minion.","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Clockmaker","team":"townsfolk","ability":"You start knowing how many steps from the Demon to its nearest Minion."},{"id":"dreamer","edition":"snv","firstNight":24,"firstNightReminder":"The Dreamer points to a player. Show two character tokens, one of which is that player’s character, the other of which is of opposite alignment to that character.","otherNight":41,"otherNightReminder":"The Dreamer points to a player. Show 1 good and 1 evil character token; one of these is correct.","reminders":[],"setup":false,"name":"Dreamer","team":"townsfolk","ability":"Each night, choose a player (not yourself): you learn 1 good and 1 evil character, 1 of which is correct."},{"id":"snakecharmer","edition":"snv","firstNight":8,"firstNightReminder":"The Snake Charmer points to a player. If that player is the Demon: • Swap the Snake Charmer and Demon character tokens. • Wake the new Demon. Show the “You are” card, then the thumb-down “evil” sign. Show the “You are” card, then the Demon token. • The new Snake Charmer is poisoned . Wake the new Snake Charmer. Show the “You are” card, then the thumb-up “good” sign. Show the “You are” card, then the Snake Charmer token.","otherNight":7,"otherNightReminder":"The Snake Charmer points to a player. If that player is the Demon: • Swap the Snake Charmer and Demon character tokens. Wake the new Demon. Show the “You are” card, then the thumb-down “evil” sign. Show the “You are” card, then the Demon token. • The new Snake Charmer is poisoned . Wake the new Snake Charmer. Show the “You are” card, then the thumb-up “good” sign. Show the “You are” card, then the Snake Charmer token.","reminders":["Poisoned"],"setup":false,"name":"Snake Charmer","team":"townsfolk","ability":"Each night, choose an alive player: a chosen Demon swaps characters and alignments with you and is then poisoned."},{"id":"mathematician","edition":"snv","firstNight":27,"firstNightReminder":"Show the hand signal for the number (0, 1, 2, etc.) of “Abnormal Effect” markers. Remove markers","otherNight":48,"otherNightReminder":"Show the hand signal for the number (0, 1, 2, etc.) of “Abnormal Effect” markers. Remove markers.","reminders":["Abnormal effect"],"setup":false,"name":"Mathematician","team":"townsfolk","ability":"Each night, you learn how many players\' abilities worked abnormally (since dawn) due to another character\'s ability."},{"id":"flowergirl","edition":"snv","firstNight":0,"firstNightReminder":"Place the “Demon did not vote” marker.","otherNight":43,"otherNightReminder":"Show the head signal (nod “yes”, shake “no”) for whether the Demon voted today. Place the “Demon did not vote” marker (remove “Demon voted”, if any).","reminders":["Demon did vote","Demon did not vote"],"setup":false,"name":"Flowergirl","team":"townsfolk","ability":"Each night*, you learn if the Demon voted today."},{"id":"towncrier","edition":"snv","firstNight":0,"firstNightReminder":"Place the “Minions did not nominate” marker.","otherNight":44,"otherNightReminder":"Show the head signal (nod “yes”, shake “no”) for whether any Minion nominated today. Place the “Minions did not nominate” marker (remove “Minion nominated”, if any).","reminders":["No Minion nominated","Minion nominated"],"setup":false,"name":"Town Crier","team":"townsfolk","ability":"Each night*, you learn if a Minion nominated today."},{"id":"oracle","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":45,"otherNightReminder":"Show the hand signal for the number (0, 1, 2, etc.) of dead evil players.","reminders":[],"setup":false,"name":"Oracle","team":"townsfolk","ability":"Each night*, you learn how many dead players are evil."},{"id":"savant","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Savant","team":"townsfolk","ability":"Each day, you may visit the Storyteller to learn 2 things in private: 1 is true and 1 is false."},{"id":"seamstress","edition":"snv","firstNight":25,"firstNightReminder":"The Seamstress either shows a “no” head signal, or points to two other players. If the Seamstress chose two players , nod “yes” or shake “no” for whether they are of same alignment.","otherNight":42,"otherNightReminder":"If the Seamstress has not yet used their ability: • The Seamstress either shows a “no” head signal, or points to two other players. • If the Seamstress chose players , nod “yes” or shake “no” for whether they are of same alignment.","reminders":["Used"],"setup":false,"name":"Seamstress","team":"townsfolk","ability":"Once per game, at night, choose 2 players (not yourself): you learn if they are the same alignment."},{"id":"philosopher","edition":"snv","firstNight":2,"firstNightReminder":"The Philosopher either shows a “no” head signal, or points to a good character on their sheet. If they chose a character: Swap the out-of-play character token with the Philosopher token. Or, if the character is in play, that player is drunk and the Philosopher is now that character .","otherNight":1.5,"otherNightReminder":"If the Philosopher has not yet used their ability: • The Philosopher either shows a “no” head signal, or points to a good character on their sheet. • If they chose a character: Swap the out-of-play character token with the Philosopher token. Or, if the character is in play, that player is drunk and the Philosopher is now that character .","reminders":["Used","Drunk"],"setup":false,"name":"Philosopher","team":"townsfolk","ability":"Once per game, at night, choose a good character: become them. If you duplicate an in-play character, they are drunk."},{"id":"artist","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Artist","team":"townsfolk","ability":"Once per game, during the day, privately ask the Storyteller any yes/no question."},{"id":"juggler","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":46,"otherNightReminder":"If today was the Juggler’s first day: • Show the hand signal for the number (0, 1, 2, etc.) of “Correct” markers. Remove markers.","reminders":["Correct"],"setup":false,"name":"Juggler","team":"townsfolk","ability":"On your 1st day, publicly guess up to 5 player\'s characters. That night, you learn how many you got correct."},{"id":"sage","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":36,"otherNightReminder":"If the Sage was killed by a Demon: • Point to two players, one of which is that Demon.","reminders":[],"setup":false,"name":"Sage","team":"townsfolk","ability":"If the Demon kills you, you learn that it is 1 of 2 players."},{"id":"mutant","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Mutant","team":"outsider","ability":"If you are \\"mad\\" about being an Outsider, you might be executed."},{"id":"sweetheart","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":33,"otherNightReminder":"","reminders":["Drunk"],"setup":false,"name":"Sweetheart","team":"outsider","ability":"If you die, 1 player is drunk from now on."},{"id":"barber","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":27,"otherNightReminder":"If the Barber died today : • Wake the Demon. Show the “This character selected you” card, then Barber token. • The Demon either shows a “no” head signal, or points to 2 non-Demon players. If they chose players: ◦ Swap the character tokens. Wake each player. Show “You are”, then their character token.","reminders":["Swap"],"setup":false,"name":"Barber","team":"outsider","ability":"If you die, tonight the Demon may choose 2 players (not another Demon) to swap characters."},{"id":"klutz","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Klutz","team":"outsider","ability":"When you learn that you died, publicly choose 1 alive player: if they are evil, your team loses."},{"id":"eviltwin","edition":"snv","firstNight":11,"firstNightReminder":"Wake the Evil Twin and their twin. Confirm that they have acknowledged each other. Point to the Evil Twin. Show their Evil Twin token to the twin player. Point to the twin. Show their character token to the Evil Twin player.","otherNight":0,"otherNightReminder":"","reminders":["Twin"],"setup":false,"name":"Evil Twin","team":"minion","ability":"You and an opposing player know each other. If the good player is executed, evil wins. Good can\'t win if you both live."},{"id":"witch","edition":"snv","firstNight":12,"firstNightReminder":"The Witch points to a player. That player is cursed for the next day.","otherNight":10,"otherNightReminder":"The Witch points to a player. That player is cursed for the next day.","reminders":["Cursed"],"setup":false,"name":"Witch","team":"minion","ability":"Each night, choose a player: if they nominate tomorrow, they die. If just 3 players live, you lose this ability."},{"id":"cerenovus","edition":"snv","firstNight":13,"firstNightReminder":"The Cerenovus points to a player, then to a character on their sheet. That player should “be mad about” being that character. Wake that player. Show the “This character selected you” card, then the Cerenovus token. Show the “mad about being” marker, then that character token.","otherNight":11,"otherNightReminder":"The Cerenovus points to a player, then to a character on their sheet. That player should “be mad about” being that character. . Wake that player. Show the “This character selected you” card, then the Cerenovus token. Show the “mad about being” marker, then that character token.","reminders":["Mad"],"setup":false,"name":"Cerenovus","team":"minion","ability":"Each night, choose a player and a good character: they are \\"mad\\" they are this character tomorrow, or might be executed."},{"id":"pithag","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":12,"otherNightReminder":"","reminders":[],"setup":false,"name":"Pit-Hag","team":"minion","ability":"Each night*, choose a player and a character they become (if not-in-play). If a Demon is made, deaths tonight are arbitrary."},{"id":"fanggu","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":22,"otherNightReminder":"The Fang Gu points to a player. That player dies . Or, if that player was an Outsider: • The Fang Gu dies instead of the chosen player. The chosen player is now an evil Fang Gu. • Wake the new Fang Gu. Show the “You are” card, then the Fang Gu token. Show the “You are” card, then the thumb-down “evil” hand sign.","reminders":["Die"],"setup":true,"name":"Fang Gu","team":"demon","ability":"Each night*, choose a player: they die. The 1st Outsider chosen becomes an evil Fang Gu and you die instead. [+1 Outsider]"},{"id":"vigormortis","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":25,"otherNightReminder":"The Vigormortis points to a player. That player dies. If a Minion, they keep their ability and one of their Townsfolk neighbours is poisoned .","reminders":["Die","Poisoned","Ability active"],"setup":true,"name":"Vigormortis","team":"demon","ability":"Each night*, choose a player: they die. Minions you kill keep their ability and poison 1 Townsfolk neighbor. [-1 Outsider]."},{"id":"nodashii","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":23,"otherNightReminder":"The No Dashii points to a player. That player dies.","reminders":["Die","Poisoned"],"setup":false,"name":"No Dashii","team":"demon","ability":"Each night*, choose a player: they die. Your 2 Townsfolk neighbors are poisoned."},{"id":"vortox","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":24,"otherNightReminder":"The Vortox points to a player. That player dies.","reminders":["Die"],"setup":false,"name":"Vortox","team":"demon","ability":"Each night*, choose a player: they die. Good abilities yield false information. Each day, if no-one was executed, evil wins."},{"id":"scapegoat","edition":"tb","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Scapegoat","team":"traveler","ability":"If a player of your alignment is executed, you might be executed instead."},{"id":"gunslinger","edition":"tb","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Gunslinger","team":"traveler","ability":"Each day, after the 1st vote has been tallied, you may choose a player that voted: they die."},{"id":"beggar","edition":"tb","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Beggar","team":"traveler","ability":"You must use a vote token to vote. Dead players may choose to give you theirs. If so, you learn their alignment."},{"id":"bureaucrat","edition":"tb","firstNight":1,"firstNightReminder":"The Bureaucrat points to a player. Put the Bureaucrat\'s “Vote x3” reminder by the chosen player\'s character token.","otherNight":1,"otherNightReminder":"The Bureaucrat points to a player. Put the Bureaucrat\'s “Vote x3” reminder by the chosen player\'s character token.","reminders":["Vote x3"],"setup":false,"name":"Bureaucrat","team":"traveler","ability":"Each night, choose a player (not yourself): their vote counts as 3 votes tomorrow."},{"id":"thief","edition":"tb","firstNight":1,"firstNightReminder":"The Thief points to a player. Put the Thief\'s “Negative vote” reminder by the chosen player\'s character token.","otherNight":1,"otherNightReminder":"The Thief points to a player. Put the Thief\'s “Negative vote” reminder by the chosen player\'s character token.","reminders":["Negative vote"],"setup":false,"name":"Thief","team":"traveler","ability":"Each night, choose a player (not yourself): their vote counts negatively tomorrow."},{"id":"apprentice","edition":"bmr","firstNight":1,"firstNightReminder":"Show the Apprentice the \\"You are\\" info token, then a Townsfolk or Minion token. In the Grimoire, replace the Apprentice token with that character token, and put the Apprentice\'s \\"Apprentice ability\\" reminder by that character token.","otherNight":0,"otherNightReminder":"","reminders":["Apprentice ability"],"setup":false,"name":"Apprentice","team":"traveler","ability":"On your 1st night, you gain a Townsfolk ability (if good), or a Minion ability (if evil)."},{"id":"matron","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Matron","team":"traveler","ability":"Each day, you may choose up to 3 pairs of players to swap seats. Players may not leave their seats to talk in private."},{"id":"voudon","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Voudon","team":"traveler","ability":"Only you and the dead can vote. They don\'t need a vote token to do so. A 50% majority is not required."},{"id":"judge","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Judge","team":"traveler","ability":"Once per game, if another player nominated, you may choose to force the current execution to pass or fail."},{"id":"bishop","edition":"bmr","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Nominate Good","Nominate Evil"],"setup":false,"name":"Bishop","team":"traveler","ability":"Only the Storyteller can nominate. At least 1 opposite player must be nominated each day."},{"id":"butcher","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Butcher","team":"traveler","ability":"Each day, after the 1st execution, you nominate again."},{"id":"bonecollector","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":1,"otherNightReminder":"The Bone Collector either shake their head no or point at any dead player. If they pointed at any dead player, put the Bone Collector\'s \\"Has Ability\\" reminder by the chosen player\'s character token. (They may need to be woken tonight to use it.)","reminders":["Used","Has Ability"],"setup":false,"name":"Bone Collector","team":"traveler","ability":"Once per game, at night, choose a dead player: they regain their ability until dusk."},{"id":"harlot","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":1,"otherNightReminder":"The Harlot points at any player. Then, put the Harlot to sleep. Wake the chosen player, show them the \\"This character selected you\\" token, then the Harlot token. That player either nods their head yes or shakes their head no. If they nodded their head yes, wake the Harlot and show them the chosen player\'s character token. Then, you may decide that both players die.","reminders":["Die"],"setup":false,"name":"Harlot","team":"traveler","ability":"Each night*, choose a living player: if they agree, you learn their character, but you both might die."},{"id":"barista","edition":"snv","firstNight":1,"firstNightReminder":"Each night, put the Barista\'s \\"Sober and Healthy\\" reminder or their \\"Acts Twice\\" reminder by any character token. Wake that character’s player and show them the “This player selected you” info token, then the Barista token, then one finger (to show they are sober and healthy) or two fingers (to show they act twice).","otherNight":1,"otherNightReminder":"Each night, put the Barista\'s \\"Sober and Healthy\\" reminder or their \\"Acts Twice\\" reminder by any character token. Wake that character’s player and show them the “This player selected you” info token, then the Barista token, then one finger (to show they are sober and healthy) or two fingers (to show they act twice).","reminders":["Acts Twice","Sober and Healthy"],"setup":false,"name":"Barista","team":"traveler","ability":"Each night, until dusk, 1) a player becomes sober, healthy and gets true info, or 2) their ability works twice. They learn which."},{"id":"deviant","edition":"snv","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Deviant","team":"traveler","ability":"If you were funny today, you can not be exiled."},{"id":"balloonist","edition":"","firstNight":24,"firstNightReminder":"Choose a character type. Point to a player whose character is of that type. Place the Balloonist\'s \\"Seen\\" reminder next to that character.","otherNight":44,"otherNightReminder":"Choose a character type you have not chosen yet. Point to a player whose character is of that type, if there are any. Place the Balloonist\'s \\"Seen\\" reminder next to that character.","reminders":["Seen"],"setup":true,"name":"Balloonist","team":"townsfolk","ability":"Each night, you learn 1 player of each character type, until there are no more types to learn. [+1 Outsider]"},{"id":"amnesiac","edition":"","firstNight":21,"firstNightReminder":"Decide the Amnesiac\'s entire ability. If the Amnesiac\'s ability causes them to wake tonight: Wake the Amnesiac and run their ability.","otherNight":30,"otherNightReminder":"If the Amnesiac\'s ability causes them to wake tonight: Wake the Amnesiac and run their ability.","reminders":[],"setup":false,"name":"Amnesiac","team":"townsfolk","ability":"You do not know what your ability is. Each day, privately guess what it is: you learn how accurate you are."},{"id":"cannibal","edition":"","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Ability gained","Poisoned"],"setup":false,"name":"Cannibal","team":"townsfolk","ability":"You have the ability of the recently killed executee. If they are evil, you are poisoned until a good player dies this way."},{"id":"fisherman","edition":"","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Fisherman","team":"townsfolk","ability":"Once per game, during the day, visit the Storyteller for some advice to help you win."},{"id":"goblin","edition":"","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":["Claimed today"],"setup":false,"name":"Goblin","team":"minion","ability":"When nominated, you may publicly claim to be the Goblin: if you are executed that day, your team wins."},{"id":"widow","edition":"","firstNight":26,"firstNightReminder":"Show the Grimoire to the Widow for as long as they need. The Widow points to a player. That player is poisoned. Wake a good player. Show the “These characters are in play” card, then the Widow character token.","otherNight":0,"otherNightReminder":"","reminders":["Poisoned","Knowing"],"setup":false,"name":"Widow","team":"minion","ability":"On your 1st night, look at the Grimoire and choose a player: they are poisoned. 1 good player knows a Widow is in play."},{"id":"leviathan","edition":"","firstNight":100,"firstNightReminder":"Place the Leviathan “Day 1” marker. Announce “The Leviathan is in play; this is Day 1.”.","otherNight":100,"otherNightReminder":"Place the next Leviathan “Day n” marker, where “n” is the day number. Announce “The Leviathan is in play; this is Day n.”.","reminders":["Good executed","Day 1","Day 2","Day 3","Day 4","Day 5"],"setup":false,"name":"Leviathan","team":"demon","ability":"All players know you are in play. After 5 days, evil wins. If more than 1 good player is executed, evil wins."},{"id":"acrobat","edition":"","firstNight":0,"firstNightReminder":"","otherNight":49,"otherNightReminder":"If either good living neighbor is drunk or poisoned, the Acrobat dies.","reminders":["Die"],"setup":false,"name":"Acrobat","team":"outsider","ability":"Each night*, if either good living neighbor is drunk or poisoned, you die."},{"id":"bountyhunter","edition":"","firstNight":10,"firstNightReminder":"Point to a player that is evil.","otherNight":37,"otherNightReminder":"If the evil player that was known by the Bounty Hunter died since the previous night: Point to another player that is evil.","reminders":["Known"],"setup":true,"name":"Bounty Hunter","team":"townsfolk","ability":"You start knowing 1 evil player. If the evil player you know dies, you learn another that night. [1 Townsfolk is evil]"},{"id":"cultleader","edition":"","firstNight":30,"firstNightReminder":"The Cult Leader becomes the alignment of an alive neighbor: Show the “You are” card. Show the hand signal (thumb-up “good”, thumb-down “evil”) for the Cult Leader\'s current alignment.","otherNight":51,"otherNightReminder":"The Cult Leader becomes the alignment of an alive neighbor: Show the “You are” card. Show the hand signal (thumb-up “good”, thumb-down “evil”) for the Cult Leader\'s current alignment.","reminders":[],"setup":false,"name":"Cult Leader","team":"townsfolk","ability":"Each night, you become the alignment of an alive neighbor. If all good players choose to join your cult, your team wins."},{"id":"preacher","edition":"","firstNight":7,"firstNightReminder":"The Preacher points to a player. If that player is a Minion: Wake the Minion. Show the Preacher token. The Minion now does not have an ability anymore.","otherNight":6,"otherNightReminder":"The Preacher points to a player. If that player is a Minion: Wake the Minion. Show the Preacher token. The Minion now does not have an ability anymore.","reminders":["No ability"],"setup":false,"name":"Preacher","team":"townsfolk","ability":"Each night, choose a player: a Minion, if chosen, learns this. All chosen Minions have no ability."},{"id":"politician","edition":"","firstNight":0,"firstNightReminder":"","otherNight":0,"otherNightReminder":"","reminders":[],"setup":false,"name":"Politician","team":"outsider","ability":"If you were the player most responsible for your team losing, you change alignment & win, even if dead."},{"id":"lilmonsta","edition":"","firstNight":14,"firstNightReminder":"Wake all Minions. The Minions point to a player that receives the Lil\' Monsta token and becomes the Demon.","otherNight":17,"otherNightReminder":"Wake all Minions. The Minions point to a player that receives the Lil\' Monsta token and becomes the Demon. Choose a player that dies.","reminders":[],"remindersGlobal":["Die","The Demon"],"setup":true,"name":"Lil\' Monsta","team":"demon","ability":"Each night, Minions choose who babysits Lil\' Monsta\'s token & “is the Demon”. A player dies each night*. [+1 Minion]"}]')},b201:function(e,t,i){"use strict";var o=i("b097"),s=i.n(o);s.a},b223:function(e,t,i){e.exports=i.p+"img/mayor.98dda8d8.png"},b242:function(e,t,i){},b249:function(e){e.exports=JSON.parse('[{"id":"doomsayer","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Doomsayer","team":"fabled","ability":"If 4 or more players live, each living player may publicly choose (once per game) that a player of their own alignment dies."},{"id":"angel","firstNightReminder":"","otherNightReminder":"","reminders":["Protect","Punish"],"setup":false,"name":"Angel","team":"fabled","ability":"Something bad might happen to whoever is most responsible for the death of a new player."},{"id":"buddhist","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Buddhist","team":"fabled","ability":"For the first 2 minutes of each day, veteran players may not talk."},{"id":"hellslibrarian","firstNightReminder":"","otherNightReminder":"","reminders":["Punish"],"setup":false,"name":"Hell\'s Librarian","team":"fabled","ability":"Something bad might happen to whoever talks when the Storyteller has asked for silence."},{"id":"revolutionary","firstNightReminder":"","otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Revolutionary","team":"fabled","ability":"2 neighboring players are known to be the same alignment. Once per game, one of them registers falsely."},{"id":"fiddler","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":false,"name":"Fiddler","team":"fabled","ability":"Once per game, the Demon secretly chooses an opposing player: all players choose which of these 2 players win."},{"id":"toymaker","firstNightReminder":"","otherNightReminder":"If it is a night when a Demon attack could end the game, and the Demon is marked “Final night: No Attack,” then the Demon does not act tonight. (Do not wake them.)","reminders":["Final Night: No Attack"],"setup":false,"name":"Toymaker","team":"fabled","ability":"The Demon may choose not to attack & must do this at least once per game. Evil players get normal starting info."},{"id":"fibbin","firstNightReminder":"","otherNightReminder":"","reminders":["Used"],"setup":false,"name":"Fibbin","team":"fabled","ability":"Once per game, 1 good player might get false information."},{"id":"duchess","firstNightReminder":"","otherNightReminder":"Wake each player marked “Visitor” or “False Info” one at a time. Show them the Duchess token, then fingers (1, 2, 3) equaling the number of evil players marked “Visitor” or, if you are waking the player marked “False Info,” show them any number of fingers except the number of evil players marked “Visitor.”","reminders":["Visitor","False Info"],"setup":false,"name":"Duchess","team":"fabled","ability":"Each day, 3 players may choose to visit you. At night*, each visitor learns how many visitors are evil, but 1 gets false info."},{"id":"sentinel","firstNightReminder":"","otherNightReminder":"","reminders":[],"setup":true,"name":"Sentinel","team":"fabled","ability":"There might be 1 extra or 1 fewer Outsider in play."},{"id":"spiritofivory","firstNightReminder":"","otherNightReminder":"","reminders":["No extra evil"],"setup":false,"name":"Spirit of Ivory","team":"fabled","ability":"There can\'t be more than 1 extra evil player."},{"id":"djinn","firstNightReminder":"Wake each evil player and show them which jinxed characters are in play, so that they know not to bluff as characters that can not be in play.","otherNightReminder":"","reminders":[],"setup":false,"name":"Djinn","team":"fabled","ability":"Jinxed characters are not both in-play, but evil players know which ones are. Or, use the Djinn\'s \\"Special Rule\\"."}]')},b30c:function(e,t,i){e.exports=i.p+"img/professor.8a5ccf04.png"},b391:function(e,t,i){"use strict";var o=i("6e24"),s=i.n(o);s.a},b570:function(e,t,i){e.exports=i.p+"img/investigator.13194f19.png"},ba9b:function(e,t,i){e.exports=i.p+"img/tealady.2d47353e.png"},bb7a:function(e,t,i){e.exports=i.p+"img/empath.d7a89ed7.png"},bfe2:function(e,t,i){e.exports=i.p+"img/angel.016b2c65.png"},c24f:function(e,t,i){e.exports=i.p+"img/evil.908a2622.png"},c37d:function(e,t,i){},c492:function(e,t,i){e.exports=i.p+"img/lilmonsta.e4a265ca.png"},c5db:function(e,t,i){e.exports=i.p+"img/fisherman.9077de7e.png"},c73a:function(e,t,i){e.exports=i.p+"img/po.4c484011.png"},c9f5:function(e,t,i){e.exports=i.p+"img/grandmother.16001541.png"},cadc:function(e,t,i){e.exports=i.p+"img/gossip.dd8d7312.png"},cd8b:function(e,t,i){e.exports=i.p+"img/devilsadvocate.e455fea0.png"},cf8b:function(e,t,i){"use strict";var o=i("b242"),s=i.n(o);s.a},cfcc:function(e,t,i){e.exports=i.p+"img/beggar.b7a4fbda.png"},d4b2:function(e,t,i){},d62b:function(e,t,i){e.exports=i.p+"img/slayer.0859544b.png"},d715:function(e,t,i){e.exports=i.p+"img/savant.16bfbc30.png"},d88a:function(e,t,i){"use strict";var o=i("9f7d"),s=i.n(o);s.a},d97d:function(e,t,i){e.exports=i.p+"img/drunk.4883c5a1.png"},dce6:function(e,t,i){e.exports=i.p+"img/gambler.000b4b9b.png"},dfb1:function(e,t){e.exports=e=>{if(localStorage.getItem("background")&&e.commit("setBackground",localStorage.background),localStorage.getItem("zoom")&&e.commit("setZoom",parseFloat(localStorage.getItem("zoom"))),void 0!==localStorage.isPublic&&e.commit("toggleGrimoire",JSON.parse(localStorage.isPublic)),void 0!==localStorage.edition&&e.commit("setEdition",localStorage.edition),void 0!==localStorage.roles&&e.commit("setCustomRoles",JSON.parse(localStorage.roles)),void 0!==localStorage.bluffs&&JSON.parse(localStorage.bluffs).forEach((t,i)=>{e.commit("setBluff",{index:i,role:e.state.roles.get(t)||{}})}),void 0!==localStorage.fabled&&e.commit("setFabled",{fabled:JSON.parse(localStorage.fabled).map(t=>e.state.fabled.get(t))}),localStorage.players&&e.commit("players/set",JSON.parse(localStorage.players).map(t=>({...t,role:e.state.roles.get(t.role)||{}}))),localStorage.getItem("playerId")&&e.commit("session/setPlayerId",localStorage.getItem("playerId")),localStorage.getItem("session")){const[t,i]=JSON.parse(localStorage.getItem("session"));e.commit("session/setSpectator",t),e.commit("session/setSessionId",i)}e.subscribe(({type:e,payload:t},i)=>{switch(e){case"toggleGrimoire":localStorage.setItem("isPublic",JSON.stringify(i.grimoire.isPublic));break;case"setBackground":t?localStorage.setItem("background",t):localStorage.removeItem("background");break;case"setZoom":0!==t?localStorage.setItem("zoom",t):localStorage.removeItem("zoom");break;case"setEdition":"custom"===t?localStorage.removeItem("edition"):(localStorage.setItem("edition",t),localStorage.removeItem("roles"));break;case"setCustomRoles":t.length?localStorage.setItem("roles",JSON.stringify(t)):localStorage.removeItem("roles");break;case"setBluff":localStorage.setItem("bluffs",JSON.stringify(i.grimoire.bluffs.map(({id:e})=>e)));break;case"setFabled":localStorage.setItem("fabled",JSON.stringify(i.grimoire.fabled.map(({id:e})=>e)));break;case"players/add":case"players/update":case"players/remove":case"players/clear":case"players/set":case"players/swap":case"players/move":i.players.players.length?localStorage.setItem("players",JSON.stringify(i.players.players.map(e=>({...e,role:e.role.id||{}})))):localStorage.removeItem("players");break;case"session/setSessionId":t?localStorage.setItem("session",JSON.stringify([i.session.isSpectator,t])):localStorage.removeItem("session");break;case"session/setPlayerId":t?localStorage.setItem("playerId",t):localStorage.removeItem("playerId");break}})}},e014:function(e,t,i){e.exports=i.p+"img/eviltwin.06a5a8b8.png"},e222:function(e,t,i){e.exports=i.p+"img/djinn.f10cec5c.png"},e5b4:function(e,t,i){},ec1e:function(e,t,i){e.exports=i.p+"img/spy.b739966f.png"},ee02:function(e,t,i){e.exports=i.p+"img/courtier.345180fb.png"},ee63:function(e,t,i){"use strict";var o=i("44d0"),s=i.n(o);s.a},ee92:function(e,t,i){e.exports=i.p+"img/gunslinger.9f84c9f2.png"},ef58:function(e,t,i){"use strict";var o=i("0820"),s=i.n(o);s.a},eff4:function(e,t,i){e.exports=i.p+"img/virgin.eaf181e8.png"},f09b:function(e,t,i){e.exports=i.p+"img/judge.79ec3877.png"},f1e5:function(e,t,i){e.exports=i.p+"img/sweetheart.ec1cef03.png"},f282:function(e,t,i){e.exports=i.p+"img/poisoner.44c80b94.png"},f322:function(e,t,i){e.exports=i.p+"img/scarletwoman.d2cdaffd.png"},f4bd:function(e,t,i){e.exports=i.p+"img/vigormortis.7716a80d.png"},f558:function(e,t,i){e.exports=i.p+"img/witch.2f895245.png"},f834:function(e,t,i){e.exports=i.p+"img/mastermind.c3ba5fbb.png"},f93f:function(e,t,i){e.exports=i.p+"img/clockmaker.41906ffc.png"},fcc6:function(e,t,i){e.exports=i.p+"img/barber.a354ad9e.png"},fd83:function(e,t,i){e.exports=i.p+"img/custom.8ff972bc.png"},fff1:function(e,t,i){e.exports=i.p+"img/pacifist.ad2d0310.png"}});
//# sourceMappingURL=app.6910b20f.js.map